---
title: "3.6 Ubuntu Server och Linux i nÃ¤tverk"
parent: "NÃ¤tverk"
nav_order: 306
---

# 3.6 Ubuntu Server och Linux i nÃ¤tverk

### 3.6.1 GrundlÃ¤ggande nÃ¤tverkskonfiguration i Linux
PÃ¥ Linux finns nÃ¤tverket i flera â€œlagerâ€ samtidigt: kÃ¤rnan hÃ¥ller reda pÃ¥ interface, adresser och tabeller; anvÃ¤ndarverktyg (som ip) pratar med kÃ¤rnan i realtid; tjÃ¤nster (som DNS-resolvern och tidssynk) pÃ¥verkar hur namn och klockor upplevs; och bestÃ¤ndig konfiguration (pÃ¥ Ubuntu via Netplan) beskriver hur allt ska se ut efter en omstart. Det lÃ¥ter abstrakt, men poÃ¤ngen Ã¤r enkel: man skiljer pÃ¥ tillstÃ¥nd just nu och tillstÃ¥nd Ã¶ver tid. I undervisning och drift blir det dÃ¤rfÃ¶r naturligt att â€œlÃ¤saâ€ nÃ¤tet med verktyg som visar nulÃ¤get, samtidigt som man fÃ¶rstÃ¥r var den bestÃ¤ndiga sanningen faktiskt bor.
PÃ¥ Ubuntu Server beskriver Netplan nÃ¤tet i YAML-filer (vanligen /etc/netplan/*.yaml) och lÃ¥ter sedan en â€œmotorâ€ â€“ ofta systemd-networkd pÃ¥ servrar â€“ gÃ¶ra jobbet vid boot. Det gÃ¶r att sÃ¥dant som statisk IP, gateway, namnservrar, VLAN, bonding och bryggor (bridges) lever i samma modell, och att alla delar kan uttryckas lika tydligt fÃ¶r IPv4 och IPv6. NulÃ¤get speglas av moderna kommandon: ip address och ip route visar adresser och rutter, resolvectl visar hur namn faktiskt slÃ¥s upp, och networkctl ger en Ã¶versikt Ã¶ver kÃ¤nda lÃ¤nkar och deras status. VLAN pÃ¥ Linux Ã¤r inte magiskt: ett taggat underinterface (t.ex. enp3s0.20) Ã¤r bara samma fysiska port med en tydlig etikett fÃ¶r nÃ¤tet; bonding binder flera fysiska portar till en logisk (fÃ¶r redundans/kapacitet), och bryggor kopplar virtuella gÃ¤ster (container/VM) till â€œriktigaâ€ nÃ¤t. I praktiken liknar det hur du tÃ¤nker i en switch: namn pÃ¥ saker betyder mindre Ã¤n hur de kopplas.
DNS-funktionen pÃ¥ moderna Ubuntu skÃ¶ts ofta av systemd-resolved, som bÃ¥de cache:ar och vet vilken namnserver som gÃ¤ller pÃ¥ vilket interface. Det Ã¤r hÃ¤r split-horizon och â€œrÃ¤tt resolver pÃ¥ rÃ¤tt platsâ€ blir konkret: interna namn ska frÃ¥ga interna resolvers, och externa namn fÃ¥r gÃ¥ utÃ¥t. Samma logik gÃ¤ller tidssynk â€“ systemd-timesyncd eller NTP-klient â€“ dÃ¤r en liten avvikelse fÃ¥r stora fÃ¶ljder om servern ingÃ¥r i en domÃ¤n som anvÃ¤nder Kerberos. I servermiljÃ¶ Ã¤r det dessutom vanligt att separera management-trafik (administration) frÃ¥n tjÃ¤nstetrafik (det som servrarna levererar) till olika VLAN och att styra Ã¥tkomst med brandvÃ¤gg (Ubuntu har UFW som ett vÃ¤nligt grÃ¤nssnitt till underliggande paketfilter). Det gÃ¶r inte servern â€œparanoidâ€; det gÃ¶r den fÃ¶rutsÃ¤gbar.
FÃ¶rtydligande (sammanfattning):
- TvÃ¥ perspektiv: nulÃ¤ge (kÃ¤rna + verktyg) och bestÃ¤ndighet (Netplan).
- Byggstenar: VLAN fÃ¶r etiketter, bond fÃ¶r redundans/kapacitet, bridge fÃ¶r att koppla gÃ¤ster till rÃ¤tt nÃ¤t.
- TjÃ¤nster: resolved fÃ¶r namn, timesyncd/NTP fÃ¶r tid â€“ bÃ¥da styr â€œallt annatâ€.
- SÃ¤ker drift: separera management frÃ¥n tjÃ¤nstetrafik, lÃ¥t brandvÃ¤gg och riktade regler gÃ¶ra sitt.
TvÃ¥ perspektiv: nulÃ¤ge (kÃ¤rna + verktyg) och bestÃ¤ndighet (Netplan).
Byggstenar: VLAN fÃ¶r etiketter, bond fÃ¶r redundans/kapacitet, bridge fÃ¶r att koppla gÃ¤ster till rÃ¤tt nÃ¤t.
TjÃ¤nster: resolved fÃ¶r namn, timesyncd/NTP fÃ¶r tid â€“ bÃ¥da styr â€œallt annatâ€.
SÃ¤ker drift: separera management frÃ¥n tjÃ¤nstetrafik, lÃ¥t brandvÃ¤gg och riktade regler gÃ¶ra sitt.
Exempel: En Ubuntu-filserver svarar lÃ¥ngsamt pÃ¥ domÃ¤ninloggningar men â€œinternetâ€ Ã¤r snabbt. FÃ¶rklaringen Ã¤r sÃ¤llan CPU â€” det Ã¤r oftare att servern rÃ¥kar frÃ¥ga fel DNS (extern resolver utan SRV-poster) eller har en liten tidsdrift. NÃ¤r namn och tid blir rÃ¤tt, blir allt annat â€œmagisktâ€ rÃ¤tt ocksÃ¥.
### 3.6.2 SFTP, SMB, SSH, SCP
I LinuxvÃ¤rlden gÃ¶r man en poÃ¤ng av att vÃ¤lja rÃ¤tt verktyg fÃ¶r rÃ¤tt typ av Ã¶verfÃ¶ring och Ã¥tkomst. SSH Ã¤r grunden: ett sÃ¤kert skal som ger fjÃ¤rrterminal, tunnel (port forward) och subsystem som SFTP. Det viktiga fÃ¶r elever att fÃ¶rstÃ¥ Ã¤r att SFTP inte Ã¤r â€œFTP med Sâ€, utan en logisk filkanal inuti SSH â€“ vilket betyder att exakt samma identitet och kryptering som skyddar terminalen ocksÃ¥ skyddar filen. SCP Ã¤r historiskt det snabbaste sÃ¤ttet att â€œbara fÃ¥ Ã¶ver en filâ€, men i dag fÃ¶redrar mÃ¥nga SFTP (fÃ¶r robusthet och interoperabilitet) eller rsync Ã¶ver SSH (fÃ¶r diff/Ã¥terupptagning och rÃ¤ttigheter). PoÃ¤ngen Ã¤r inte att minnas alla flaggor, utan att kunna resonera: Ã¤r detta en engÃ¥ngskopia, en synk som ska kÃ¶ras nattligen, eller ett incheckat arbetsflÃ¶de?
SMB (Samba) adresserar en annan situation: samarbete med WindowsvÃ¤rlden. NÃ¤r en Linuxserver ska dela mappar till Windows-klienter Ã¤r Samba sprÃ¥ktolken som gÃ¶r att NTFS-liknande rÃ¤ttigheter (inklusive ACL) och Windows-inloggning kÃ¤nns hemma. I en skolmiljÃ¶ Ã¤r det vanligt att lÃ¥ta Samba lÃ¤sa identiteter frÃ¥n en domÃ¤n â€“ oavsett om servern formellt â€œgÃ¥r med iâ€ domÃ¤nen eller bara konsumerar gruppinformation. Det som ser enkelt ut (â€œmappar till elever och lÃ¤rareâ€) blir stabilt fÃ¶rst nÃ¤r identiteter, grupper och rÃ¤ttigheter hÃ¤nger ihop Ã¶ver protokollgrÃ¤nsen. DÃ¤rfÃ¶r Ã¤r det bra att elever kopplar SMB-upplevelsen till gruppbaserad behÃ¶righet (se 3.5): pÃ¥ Linuxsidan Ã¤gare/grupper/ACL, pÃ¥ Windows-sidan roller â€“ och Samba Ã¶versÃ¤tter.
Tillbaka till SSH: utÃ¶ver terminal och SFTP Ã¤r SSH ocksÃ¥ ett transportlager fÃ¶r andra behov. Med en local forward (t.ex. localhost:8443 â†’ â€œserverns 443â€) gÃ¥r det att administrera webbtjÃ¤nster utan att Ã¶ppna dem externt, och med ProxyJump blir en jump host/bastion fÃ¶rsta halt pÃ¥ varje resa â€“ vilket ger fÃ¤rre Ã¶ppna portar och ett tydligt spÃ¥r av vem som gjorde vad. Nyckelbaserad inloggning Ã¤r inte bara â€œbekvÃ¤mtâ€: den byta ut det som annars vore ett lÃ¶senord pÃ¥ nÃ¤tet mot kryptografiska bevis. I skolmiljÃ¶ fÃ¶rsvinner mycket friktion nÃ¤r man fÃ¶rklarar varfÃ¶r det Ã¤r vÃ¤rt att hÃ¥lla ordning pÃ¥ nycklar (och deras passfraser), snarare Ã¤n att lÃ¤gga energi pÃ¥ att komma ihÃ¥g â€œdet senaste superlÃ¶senordetâ€.
FÃ¶rtydligande (sammanfattning):
- SSH: fjÃ¤rrskal, tunnlar, SFTP-subsystem; nycklar ger bÃ¥de sÃ¤kerhet och smidighet.
- SFTP/SCP/rsync: tÃ¤nk fall â€“ engÃ¥ng vs synk vs rÃ¤ttighetsbevarande.
- SMB (Samba): bro mellan Linuxfilsystem och Windowsklienter; identitet + ACL gÃ¶r att allt â€œkÃ¤nns likadantâ€ fÃ¶r anvÃ¤ndaren.
- Bastion: en obligatorisk mellanlandning gÃ¶r adminspÃ¥r tydligt och ytan mindre.
SSH: fjÃ¤rrskal, tunnlar, SFTP-subsystem; nycklar ger bÃ¥de sÃ¤kerhet och smidighet.
SFTP/SCP/rsync: tÃ¤nk fall â€“ engÃ¥ng vs synk vs rÃ¤ttighetsbevarande.
SMB (Samba): bro mellan Linuxfilsystem och Windowsklienter; identitet + ACL gÃ¶r att allt â€œkÃ¤nns likadantâ€ fÃ¶r anvÃ¤ndaren.
Bastion: en obligatorisk mellanlandning gÃ¶r adminspÃ¥r tydligt och ytan mindre.
Exempel: En Ã¤mnesansvarig lÃ¤rare vill lÃ¤gga upp stora kursfiler pÃ¥ filservern frÃ¥n hemmet. Med rsync Ã¶ver SSH kopieras bara det som Ã¤ndrats, rÃ¤ttigheterna bevaras, och Ã¶verfÃ¶ringen kan Ã¥terupptas. NÃ¤r lÃ¤raren Ã¤r pÃ¥ skolan monteras samma mapp som SMB pÃ¥ lÃ¤rardatorn â€“ tvÃ¥ vÃ¤gar, samma kÃ¤lla, ingen dubbeladministration.
### 3.6.3 AnvÃ¤ndarskapande och rÃ¤ttigheter via CLI
Linux hÃ¥ller identitet enkelt och synligt: anvÃ¤ndare har UID, grupper har GID, och filsystemet bryr sig om Ã¤gare, grupp och â€œalla andraâ€ nÃ¤r det avgÃ¶r vad som Ã¤r tillÃ¥tet. I praktiken betyder det att Ã¤garskap och gruppmedlemskap Ã¤r den vardagliga valutan â€“ och att rÃ¤ttigheter (r, w, x) lÃ¤ses lite olika fÃ¶r filer och kataloger. Elever som snabbt lÃ¤r sig â€œx pÃ¥ en katalog betyder â€™fÃ¥ gÃ¥ igenomâ€™â€ fÃ¥r plÃ¶tsligt superkrafter i felsÃ¶kning: de fÃ¶rstÃ¥r varfÃ¶r en mapp â€œsom alla har rÃ¤tt tillâ€ Ã¤ndÃ¥ inte gÃ¥r att nÃ¥ (fÃ¶r att en fÃ¶rÃ¤ldramapp saknar x), och de ser varfÃ¶r en sticky bit pÃ¥ en gemensam â€œinlÃ¤mningskorgâ€ gÃ¶r att alla kan lÃ¤gga till, men bara Ã¤garen kan ta bort.
I en skolmiljÃ¶ Ã¤r det dessutom vÃ¤rt att se grupp som â€œrollenâ€ i vardagen. En lÃ¤rargrupp och en klassgrupp gÃ¥r att anvÃ¤nda bÃ¥de i Linux-ACL (fÃ¶r finmaskiga rÃ¤ttigheter och default-ACL i trÃ¤d) och i Samba (fÃ¶r att matcha WindowsvÃ¤rldens fÃ¶rvÃ¤ntningar). Samtidigt hÃ¥ller sudo ordning pÃ¥ vem som fÃ¥r eskalera till administratÃ¶r â€“ inte fÃ¶r att fÃ¶rsvÃ¥ra, utan fÃ¶r att ge ett spÃ¥rbart ja till en begrÃ¤nsad uppgift i stÃ¤llet fÃ¶r ett tyst â€œalltâ€. NÃ¤r eleverna ser hur Ã¤garskap â†’ grupp â†’ ACL hÃ¤nger ihop blir filservern begriplig och uppgiften â€œge bara lÃ¤rare rÃ¤tt att Ã¤ndra i Ã¤mnesmappenâ€ slutar vara ett mysterium.
FÃ¶rtydligande (sammanfattning):
- Identitet: UID/GID och primÃ¤r/sekundÃ¤r grupp driver mycket av vardagen.
- RÃ¤ttigheter: r/w/x tolkas olika fÃ¶r fil vs katalog; sticky, setgid pÃ¥ kataloger ger fÃ¶rutsÃ¤gbarhet i delade ytor.
- ACL: kompletterar klassiska rÃ¤ttigheter; default-ACL Ã¤r â€œÃ¤rva framÃ¥tâ€ i nyckelkataloger.
- SÃ¤ker admin: sudo ger smala, spÃ¥rbara rÃ¤ttigheter; grupper representerar roller och mappar snyggt till Samba/SMB.
Identitet: UID/GID och primÃ¤r/sekundÃ¤r grupp driver mycket av vardagen.
RÃ¤ttigheter: r/w/x tolkas olika fÃ¶r fil vs katalog; sticky, setgid pÃ¥ kataloger ger fÃ¶rutsÃ¤gbarhet i delade ytor.
ACL: kompletterar klassiska rÃ¤ttigheter; default-ACL Ã¤r â€œÃ¤rva framÃ¥tâ€ i nyckelkataloger.
SÃ¤ker admin: sudo ger smala, spÃ¥rbara rÃ¤ttigheter; grupper representerar roller och mappar snyggt till Samba/SMB.
Exempel: En gemensam â€œinlÃ¤mna-hitâ€-mapp fÃ¥r skrivrÃ¤tt fÃ¶r elever och sticky bit sÃ¥ att ingen kan ta bort nÃ¥gon annans filer. Ã„mnesmappen under samma trÃ¤d har setgid pÃ¥ katalogen sÃ¥ att nya filer alltid fÃ¥r gruppen â€œLarareâ€, och en default-ACL som ger lÃ¤rargruppen write utan att nÃ¥gon behÃ¶ver â€œkomma ihÃ¥gâ€ att Ã¤ndra.
### ğŸ“Œ KontrollfrÃ¥gor
- VarfÃ¶r skiljer Linux mellan nulÃ¤ge (kÃ¤rnans bild) och bestÃ¤ndig konfiguration (Netplan), och hur mÃ¤rks det i felsÃ¶kning?
- Hur relaterar VLAN, bonding och bridges till vardagsproblemet â€œkoppla rÃ¤tt gÃ¤ster till rÃ¤tt nÃ¤tâ€?
- VarfÃ¶r pÃ¥verkar DNS-resolvern och tidssynk ofta â€œallt annatâ€, och vilka symptom brukar du se nÃ¤r de Ã¤r fel?
- FÃ¶rklara varfÃ¶r SFTP inte Ã¤r â€œFTP + krypteringâ€ utan ett SSH-subsystem, och vad det betyder fÃ¶r identitet och sÃ¤kerhet.
- NÃ¤r Ã¤r SCP tillrÃ¤ckligt och nÃ¤r bÃ¶r du hellre vÃ¤lja rsync Ã¶ver SSH?
- Vilken roll spelar Samba i en blandad miljÃ¶, och hur kopplar den samman Linux-rÃ¤ttigheter med Windows-roller?
- Vad betyder x pÃ¥ katalog jÃ¤mfÃ¶rt med x pÃ¥ fil, och varfÃ¶r stoppar avsaknad av x ibland Ã¥tkomst trots â€œreadâ€?
- Hur hjÃ¤lper setgid pÃ¥ en katalog och default-ACL till att hÃ¥lla en delad Ã¤mnesmapp konsekvent?
- VarfÃ¶r Ã¤r sudo att fÃ¶redra framfÃ¶r â€œlogga in som rootâ€, och vad vinner du pÃ¥ gruppbaserad delegering?
- Beskriv ett scenario dÃ¤r en server upplevs â€œseg mot domÃ¤nenâ€ fast internet Ã¤r snabbt â€” vilka tvÃ¥ saker kontrollerar du fÃ¶rst, och varfÃ¶r?
VarfÃ¶r skiljer Linux mellan nulÃ¤ge (kÃ¤rnans bild) och bestÃ¤ndig konfiguration (Netplan), och hur mÃ¤rks det i felsÃ¶kning?
Hur relaterar VLAN, bonding och bridges till vardagsproblemet â€œkoppla rÃ¤tt gÃ¤ster till rÃ¤tt nÃ¤tâ€?
VarfÃ¶r pÃ¥verkar DNS-resolvern och tidssynk ofta â€œallt annatâ€, och vilka symptom brukar du se nÃ¤r de Ã¤r fel?
FÃ¶rklara varfÃ¶r SFTP inte Ã¤r â€œFTP + krypteringâ€ utan ett SSH-subsystem, och vad det betyder fÃ¶r identitet och sÃ¤kerhet.
NÃ¤r Ã¤r SCP tillrÃ¤ckligt och nÃ¤r bÃ¶r du hellre vÃ¤lja rsync Ã¶ver SSH?
Vilken roll spelar Samba i en blandad miljÃ¶, och hur kopplar den samman Linux-rÃ¤ttigheter med Windows-roller?
Vad betyder x pÃ¥ katalog jÃ¤mfÃ¶rt med x pÃ¥ fil, och varfÃ¶r stoppar avsaknad av x ibland Ã¥tkomst trots â€œreadâ€?
Hur hjÃ¤lper setgid pÃ¥ en katalog och default-ACL till att hÃ¥lla en delad Ã¤mnesmapp konsekvent?
VarfÃ¶r Ã¤r sudo att fÃ¶redra framfÃ¶r â€œlogga in som rootâ€, och vad vinner du pÃ¥ gruppbaserad delegering?
Beskriv ett scenario dÃ¤r en server upplevs â€œseg mot domÃ¤nenâ€ fast internet Ã¤r snabbt â€” vilka tvÃ¥ saker kontrollerar du fÃ¶rst, och varfÃ¶r?
### ğŸ”— FÃ¶rdjupningslÃ¤nkar
- Ubuntu Server Guide (nÃ¤tverk, lagring, tjÃ¤nster): https://ubuntu.com/server/docs
- Netplan â€“ Ã¶versikt och exempel: https://netplan.io/
- systemd-networkd / networkctl â€“ nÃ¤t pÃ¥ systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd.network.html
- systemd-resolved / resolvectl â€“ DNS i systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd-resolved.service.html
- OpenSSH â€“ klient/server och nycklar: https://www.openssh.com/manual.html
- Samba â€“ dokumentation och wiki: https://www.samba.org/samba/docs/
- rsync â€“ manual och best practices: https://download.samba.org/pub/rsync/rsync.html
- POSIX ACL â€“ getfacl/setfacl: https://man7.org/linux/man-pages/man5/acl.5.html
- FilrÃ¤ttigheter och chmod: https://man7.org/linux/man-pages/man1/chmod.1.html
- AnvÃ¤ndare och grupper (useradd, groupadd): https://man7.org/linux/man-pages/man8/useradd.8.html
Ubuntu Server Guide (nÃ¤tverk, lagring, tjÃ¤nster): https://ubuntu.com/server/docs
Netplan â€“ Ã¶versikt och exempel: https://netplan.io/
systemd-networkd / networkctl â€“ nÃ¤t pÃ¥ systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd.network.html
systemd-resolved / resolvectl â€“ DNS i systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd-resolved.service.html
OpenSSH â€“ klient/server och nycklar: https://www.openssh.com/manual.html
Samba â€“ dokumentation och wiki: https://www.samba.org/samba/docs/
rsync â€“ manual och best practices: https://download.samba.org/pub/rsync/rsync.html
POSIX ACL â€“ getfacl/setfacl: https://man7.org/linux/man-pages/man5/acl.5.html
FilrÃ¤ttigheter och chmod: https://man7.org/linux/man-pages/man1/chmod.1.html
AnvÃ¤ndare och grupper (useradd, groupadd): https://man7.org/linux/man-pages/man8/useradd.8.html
### âœï¸ Egna anteckningar
â€¦