---
title: "3.6 Ubuntu Server och Linux i nätverk"
parent: "Nätverk"
nav_order: 306
---

# 3.6 Ubuntu Server och Linux i nätverk

### 3.6.1 Grundläggande nätverkskonfiguration i Linux
På Linux finns nätverket i flera “lager” samtidigt: kärnan håller reda på interface, adresser och tabeller; användarverktyg (som ip) pratar med kärnan i realtid; tjänster (som DNS-resolvern och tidssynk) påverkar hur namn och klockor upplevs; och beständig konfiguration (på Ubuntu via Netplan) beskriver hur allt ska se ut efter en omstart. Det låter abstrakt, men poängen är enkel: man skiljer på tillstånd just nu och tillstånd över tid. I undervisning och drift blir det därför naturligt att “läsa” nätet med verktyg som visar nuläget, samtidigt som man förstår var den beständiga sanningen faktiskt bor.
På Ubuntu Server beskriver Netplan nätet i YAML-filer (vanligen /etc/netplan/*.yaml) och låter sedan en “motor” – ofta systemd-networkd på servrar – göra jobbet vid boot. Det gör att sådant som statisk IP, gateway, namnservrar, VLAN, bonding och bryggor (bridges) lever i samma modell, och att alla delar kan uttryckas lika tydligt för IPv4 och IPv6. Nuläget speglas av moderna kommandon: ip address och ip route visar adresser och rutter, resolvectl visar hur namn faktiskt slås upp, och networkctl ger en översikt över kända länkar och deras status. VLAN på Linux är inte magiskt: ett taggat underinterface (t.ex. enp3s0.20) är bara samma fysiska port med en tydlig etikett för nätet; bonding binder flera fysiska portar till en logisk (för redundans/kapacitet), och bryggor kopplar virtuella gäster (container/VM) till “riktiga” nät. I praktiken liknar det hur du tänker i en switch: namn på saker betyder mindre än hur de kopplas.
DNS-funktionen på moderna Ubuntu sköts ofta av systemd-resolved, som både cache:ar och vet vilken namnserver som gäller på vilket interface. Det är här split-horizon och “rätt resolver på rätt plats” blir konkret: interna namn ska fråga interna resolvers, och externa namn får gå utåt. Samma logik gäller tidssynk – systemd-timesyncd eller NTP-klient – där en liten avvikelse får stora följder om servern ingår i en domän som använder Kerberos. I servermiljö är det dessutom vanligt att separera management-trafik (administration) från tjänstetrafik (det som servrarna levererar) till olika VLAN och att styra åtkomst med brandvägg (Ubuntu har UFW som ett vänligt gränssnitt till underliggande paketfilter). Det gör inte servern “paranoid”; det gör den förutsägbar.
Förtydligande (sammanfattning):
- Två perspektiv: nuläge (kärna + verktyg) och beständighet (Netplan).
- Byggstenar: VLAN för etiketter, bond för redundans/kapacitet, bridge för att koppla gäster till rätt nät.
- Tjänster: resolved för namn, timesyncd/NTP för tid – båda styr “allt annat”.
- Säker drift: separera management från tjänstetrafik, låt brandvägg och riktade regler göra sitt.
Två perspektiv: nuläge (kärna + verktyg) och beständighet (Netplan).
Byggstenar: VLAN för etiketter, bond för redundans/kapacitet, bridge för att koppla gäster till rätt nät.
Tjänster: resolved för namn, timesyncd/NTP för tid – båda styr “allt annat”.
Säker drift: separera management från tjänstetrafik, låt brandvägg och riktade regler göra sitt.
Exempel: En Ubuntu-filserver svarar långsamt på domäninloggningar men “internet” är snabbt. Förklaringen är sällan CPU — det är oftare att servern råkar fråga fel DNS (extern resolver utan SRV-poster) eller har en liten tidsdrift. När namn och tid blir rätt, blir allt annat “magiskt” rätt också.
### 3.6.2 SFTP, SMB, SSH, SCP
I Linuxvärlden gör man en poäng av att välja rätt verktyg för rätt typ av överföring och åtkomst. SSH är grunden: ett säkert skal som ger fjärrterminal, tunnel (port forward) och subsystem som SFTP. Det viktiga för elever att förstå är att SFTP inte är “FTP med S”, utan en logisk filkanal inuti SSH – vilket betyder att exakt samma identitet och kryptering som skyddar terminalen också skyddar filen. SCP är historiskt det snabbaste sättet att “bara få över en fil”, men i dag föredrar många SFTP (för robusthet och interoperabilitet) eller rsync över SSH (för diff/återupptagning och rättigheter). Poängen är inte att minnas alla flaggor, utan att kunna resonera: är detta en engångskopia, en synk som ska köras nattligen, eller ett incheckat arbetsflöde?
SMB (Samba) adresserar en annan situation: samarbete med Windowsvärlden. När en Linuxserver ska dela mappar till Windows-klienter är Samba språktolken som gör att NTFS-liknande rättigheter (inklusive ACL) och Windows-inloggning känns hemma. I en skolmiljö är det vanligt att låta Samba läsa identiteter från en domän – oavsett om servern formellt “går med i” domänen eller bara konsumerar gruppinformation. Det som ser enkelt ut (“mappar till elever och lärare”) blir stabilt först när identiteter, grupper och rättigheter hänger ihop över protokollgränsen. Därför är det bra att elever kopplar SMB-upplevelsen till gruppbaserad behörighet (se 3.5): på Linuxsidan ägare/grupper/ACL, på Windows-sidan roller – och Samba översätter.
Tillbaka till SSH: utöver terminal och SFTP är SSH också ett transportlager för andra behov. Med en local forward (t.ex. localhost:8443 → “serverns 443”) går det att administrera webbtjänster utan att öppna dem externt, och med ProxyJump blir en jump host/bastion första halt på varje resa – vilket ger färre öppna portar och ett tydligt spår av vem som gjorde vad. Nyckelbaserad inloggning är inte bara “bekvämt”: den byta ut det som annars vore ett lösenord på nätet mot kryptografiska bevis. I skolmiljö försvinner mycket friktion när man förklarar varför det är värt att hålla ordning på nycklar (och deras passfraser), snarare än att lägga energi på att komma ihåg “det senaste superlösenordet”.
Förtydligande (sammanfattning):
- SSH: fjärrskal, tunnlar, SFTP-subsystem; nycklar ger både säkerhet och smidighet.
- SFTP/SCP/rsync: tänk fall – engång vs synk vs rättighetsbevarande.
- SMB (Samba): bro mellan Linuxfilsystem och Windowsklienter; identitet + ACL gör att allt “känns likadant” för användaren.
- Bastion: en obligatorisk mellanlandning gör adminspår tydligt och ytan mindre.
SSH: fjärrskal, tunnlar, SFTP-subsystem; nycklar ger både säkerhet och smidighet.
SFTP/SCP/rsync: tänk fall – engång vs synk vs rättighetsbevarande.
SMB (Samba): bro mellan Linuxfilsystem och Windowsklienter; identitet + ACL gör att allt “känns likadant” för användaren.
Bastion: en obligatorisk mellanlandning gör adminspår tydligt och ytan mindre.
Exempel: En ämnesansvarig lärare vill lägga upp stora kursfiler på filservern från hemmet. Med rsync över SSH kopieras bara det som ändrats, rättigheterna bevaras, och överföringen kan återupptas. När läraren är på skolan monteras samma mapp som SMB på lärardatorn – två vägar, samma källa, ingen dubbeladministration.
### 3.6.3 Användarskapande och rättigheter via CLI
Linux håller identitet enkelt och synligt: användare har UID, grupper har GID, och filsystemet bryr sig om ägare, grupp och “alla andra” när det avgör vad som är tillåtet. I praktiken betyder det att ägarskap och gruppmedlemskap är den vardagliga valutan – och att rättigheter (r, w, x) läses lite olika för filer och kataloger. Elever som snabbt lär sig “x på en katalog betyder ’få gå igenom’” får plötsligt superkrafter i felsökning: de förstår varför en mapp “som alla har rätt till” ändå inte går att nå (för att en föräldramapp saknar x), och de ser varför en sticky bit på en gemensam “inlämningskorg” gör att alla kan lägga till, men bara ägaren kan ta bort.
I en skolmiljö är det dessutom värt att se grupp som “rollen” i vardagen. En lärargrupp och en klassgrupp går att använda både i Linux-ACL (för finmaskiga rättigheter och default-ACL i träd) och i Samba (för att matcha Windowsvärldens förväntningar). Samtidigt håller sudo ordning på vem som får eskalera till administratör – inte för att försvåra, utan för att ge ett spårbart ja till en begränsad uppgift i stället för ett tyst “allt”. När eleverna ser hur ägarskap → grupp → ACL hänger ihop blir filservern begriplig och uppgiften “ge bara lärare rätt att ändra i ämnesmappen” slutar vara ett mysterium.
Förtydligande (sammanfattning):
- Identitet: UID/GID och primär/sekundär grupp driver mycket av vardagen.
- Rättigheter: r/w/x tolkas olika för fil vs katalog; sticky, setgid på kataloger ger förutsägbarhet i delade ytor.
- ACL: kompletterar klassiska rättigheter; default-ACL är “ärva framåt” i nyckelkataloger.
- Säker admin: sudo ger smala, spårbara rättigheter; grupper representerar roller och mappar snyggt till Samba/SMB.
Identitet: UID/GID och primär/sekundär grupp driver mycket av vardagen.
Rättigheter: r/w/x tolkas olika för fil vs katalog; sticky, setgid på kataloger ger förutsägbarhet i delade ytor.
ACL: kompletterar klassiska rättigheter; default-ACL är “ärva framåt” i nyckelkataloger.
Säker admin: sudo ger smala, spårbara rättigheter; grupper representerar roller och mappar snyggt till Samba/SMB.
Exempel: En gemensam “inlämna-hit”-mapp får skrivrätt för elever och sticky bit så att ingen kan ta bort någon annans filer. Ämnesmappen under samma träd har setgid på katalogen så att nya filer alltid får gruppen “Larare”, och en default-ACL som ger lärargruppen write utan att någon behöver “komma ihåg” att ändra.
### 📌 Kontrollfrågor
- Varför skiljer Linux mellan nuläge (kärnans bild) och beständig konfiguration (Netplan), och hur märks det i felsökning?
- Hur relaterar VLAN, bonding och bridges till vardagsproblemet “koppla rätt gäster till rätt nät”?
- Varför påverkar DNS-resolvern och tidssynk ofta “allt annat”, och vilka symptom brukar du se när de är fel?
- Förklara varför SFTP inte är “FTP + kryptering” utan ett SSH-subsystem, och vad det betyder för identitet och säkerhet.
- När är SCP tillräckligt och när bör du hellre välja rsync över SSH?
- Vilken roll spelar Samba i en blandad miljö, och hur kopplar den samman Linux-rättigheter med Windows-roller?
- Vad betyder x på katalog jämfört med x på fil, och varför stoppar avsaknad av x ibland åtkomst trots “read”?
- Hur hjälper setgid på en katalog och default-ACL till att hålla en delad ämnesmapp konsekvent?
- Varför är sudo att föredra framför “logga in som root”, och vad vinner du på gruppbaserad delegering?
- Beskriv ett scenario där en server upplevs “seg mot domänen” fast internet är snabbt — vilka två saker kontrollerar du först, och varför?
Varför skiljer Linux mellan nuläge (kärnans bild) och beständig konfiguration (Netplan), och hur märks det i felsökning?
Hur relaterar VLAN, bonding och bridges till vardagsproblemet “koppla rätt gäster till rätt nät”?
Varför påverkar DNS-resolvern och tidssynk ofta “allt annat”, och vilka symptom brukar du se när de är fel?
Förklara varför SFTP inte är “FTP + kryptering” utan ett SSH-subsystem, och vad det betyder för identitet och säkerhet.
När är SCP tillräckligt och när bör du hellre välja rsync över SSH?
Vilken roll spelar Samba i en blandad miljö, och hur kopplar den samman Linux-rättigheter med Windows-roller?
Vad betyder x på katalog jämfört med x på fil, och varför stoppar avsaknad av x ibland åtkomst trots “read”?
Hur hjälper setgid på en katalog och default-ACL till att hålla en delad ämnesmapp konsekvent?
Varför är sudo att föredra framför “logga in som root”, och vad vinner du på gruppbaserad delegering?
Beskriv ett scenario där en server upplevs “seg mot domänen” fast internet är snabbt — vilka två saker kontrollerar du först, och varför?
### 🔗 Fördjupningslänkar
- Ubuntu Server Guide (nätverk, lagring, tjänster): https://ubuntu.com/server/docs
- Netplan – översikt och exempel: https://netplan.io/
- systemd-networkd / networkctl – nät på systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd.network.html
- systemd-resolved / resolvectl – DNS i systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd-resolved.service.html
- OpenSSH – klient/server och nycklar: https://www.openssh.com/manual.html
- Samba – dokumentation och wiki: https://www.samba.org/samba/docs/
- rsync – manual och best practices: https://download.samba.org/pub/rsync/rsync.html
- POSIX ACL – getfacl/setfacl: https://man7.org/linux/man-pages/man5/acl.5.html
- Filrättigheter och chmod: https://man7.org/linux/man-pages/man1/chmod.1.html
- Användare och grupper (useradd, groupadd): https://man7.org/linux/man-pages/man8/useradd.8.html
Ubuntu Server Guide (nätverk, lagring, tjänster): https://ubuntu.com/server/docs
Netplan – översikt och exempel: https://netplan.io/
systemd-networkd / networkctl – nät på systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd.network.html
systemd-resolved / resolvectl – DNS i systemd: https://www.freedesktop.org/software/systemd/man/latest/systemd-resolved.service.html
OpenSSH – klient/server och nycklar: https://www.openssh.com/manual.html
Samba – dokumentation och wiki: https://www.samba.org/samba/docs/
rsync – manual och best practices: https://download.samba.org/pub/rsync/rsync.html
POSIX ACL – getfacl/setfacl: https://man7.org/linux/man-pages/man5/acl.5.html
Filrättigheter och chmod: https://man7.org/linux/man-pages/man1/chmod.1.html
Användare och grupper (useradd, groupadd): https://man7.org/linux/man-pages/man8/useradd.8.html
### ✍️ Egna anteckningar
…