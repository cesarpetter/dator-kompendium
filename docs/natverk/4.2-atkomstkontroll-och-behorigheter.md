# 4. S√§kerhet och √∂vervakning

## 4.2 √Ötkomstkontroll och beh√∂righeter

### 4.2.1 AAA-modellen och identitet som ‚Äúvaluta‚Äù

AAA (Authentication, Authorization, Accounting) √§r tre perspektiv p√• √•tkomst:

- Authentication ‚Äì autentisering: att bevisa vem som f√∂rs√∂ker komma in (l√∂senord, certifikat, nyckel, passkey).
- Authorization ‚Äì beh√∂righet: att besluta vad den identifierade f√•r g√∂ra (roller, grupper, regler).
- Accounting ‚Äì sp√•rbarhet/loggf√∂ring: att registrera vad som faktiskt h√§nde (vem gjorde vad, n√§r, fr√•n var).

Authentication ‚Äì autentisering: att bevisa vem som f√∂rs√∂ker komma in (l√∂senord, certifikat, nyckel, passkey).

Authorization ‚Äì beh√∂righet: att besluta vad den identifierade f√•r g√∂ra (roller, grupper, regler).

Accounting ‚Äì sp√•rbarhet/loggf√∂ring: att registrera vad som faktiskt h√§nde (vem gjorde vad, n√§r, fr√•n var).

I praktiken b√§rs identiteten runt i en session (t.ex. Kerberos-biljett eller webb-token). Beh√∂righet uttrycks ofta som RBAC (Role-Based Access Control) ‚Äì ‚Äúrollen avg√∂r‚Äù ‚Äì ibland kompletterat med ABAC (Attribute-Based Access Control) d√§r attribut som plats, tid, enhetens status p√•verkar beslutet. AAA binder ihop teknik och verksamhet: man bevisar vem, beslutar vad, och bevisar i efterhand via loggar att r√§tt sak h√§nde.

F√∂rtydligande (sammanfattning):

- Autentisering = bevis; beh√∂righet = beslut; accounting = bevis i efterhand.
- RBAC modellerar roller (grupper); ABAC l√§gger p√• villkor (t.ex. ‚Äúfr√•n hanterad enhet‚Äù).
- Sessioner b√§r identiteten; loggar och tidsst√§mplar g√∂r den revisionsbar.

Autentisering = bevis; beh√∂righet = beslut; accounting = bevis i efterhand.

RBAC modellerar roller (grupper); ABAC l√§gger p√• villkor (t.ex. ‚Äúfr√•n hanterad enhet‚Äù).

Sessioner b√§r identiteten; loggar och tidsst√§mplar g√∂r den revisionsbar.

Exempel: En anv√§ndare loggar in i dom√§nen (autentisering), hamnar i grupperna G_Larare och G_Mentor (beh√∂righet), och allt deras konto g√∂r i filservern loggas med tid, IP och filstig (accounting).

### 4.2.2 Multifaktorautentisering (MFA) och motst√•nd mot phishing

MFA (Multifaktorautentisering) kombinerar minst tv√• av: n√•got du vet (l√∂senord/Pin), n√•got du har (telefon, s√§kerhetsnyckel, certifikat), n√•got du √§r (biometri). Syftet √§r att bryta kedjan d√§r ett l√§ckt l√∂senord annars r√§cker. Alla ‚Äútv√• steg‚Äù √§r inte lika: phishing-resistenta metoder som FIDO2/WebAuthn (s√§kerhetsnyckel/passkey) eller klientcertifikat √§r robustare √§n SMS-koder och enkla push-notiser. Riskbaserade signaler ‚Äì plats, ovanlig tid, ok√§nd enhet ‚Äì kan f√∂rst√§rka kravet (ABAC), men ers√§tter inte MFA.

F√∂rtydligande (sammanfattning):

- Faktorer: vet/har/√§r ‚Äì blanda minst tv√•.
- Starkast: FIDO2/WebAuthn och certifikat (motst√•nd mot phishing).
- Praktik: minimera push-tr√∂tthet; anv√§nd villkor (ABAC) f√∂r att be om starkare faktor vid risk.

Faktorer: vet/har/√§r ‚Äì blanda minst tv√•.

Starkast: FIDO2/WebAuthn och certifikat (motst√•nd mot phishing).

Praktik: minimera push-tr√∂tthet; anv√§nd villkor (ABAC) f√∂r att be om starkare faktor vid risk.

Exempel: E-post √∂ppnas p√• en skolhanterad laptop utan extra steg (enheten √§r k√§nd och compliant). Samma konto p√• en privat platta kr√§ver passkey innan √•tkomst beviljas.

### 4.2.3 Gruppolicyer och l√∂senordspolicyer (Windows-milj√∂)

I Windowsmilj√∂ uttrycks mycket av authorization via grupper och GPO (Group Policy Objects). GPO styr b√•de User Rights Assignment (vad ett konto f√•r g√∂ra i OS: logga in lokalt, via RDP, k√∂ra som tj√§nst) och milj√∂policys som p√•verkar s√§ker niv√• (l√•sning, brandv√§gg, enhetsregler). L√∂senord, l√•sning och relaterade regler definieras i en dom√§npolicy och kan f√∂rfinas med FGPP (Fine-Grained Password Policies) f√∂r s√§rskilda grupper.

Det finns ett skifte i rekommendationer: l√•nga l√∂senfraser och MFA ger b√§ttre effekt √§n t√§ta tv√•ngsbyten och komplexitetsdikt. Tvingad rotation utan indikator p√• l√§cka skapar ofta svagare l√∂senord och mer √•teranv√§ndning. F√∂r lokala administrat√∂rer ligger s√§kerheten i Windows LAPS (unika, roterade l√∂senord per klient/server) ‚Äì inte i ‚Äúett gemensamt hemligt l√∂senord‚Äù.

F√∂rtydligande (sammanfattning):

- GPO: User Rights, s√§kerhetslinjer (brandv√§gg, l√•s), policyuttryck per OU.
- L√∂senord: l√§ngd + MFA sl√•r ‚Äúkomplexitet + frekvent byte‚Äù.
- Lokala admin: Windows LAPS f√∂r unika hemligheter.

GPO: User Rights, s√§kerhetslinjer (brandv√§gg, l√•s), policyuttryck per OU.

L√∂senord: l√§ngd + MFA sl√•r ‚Äúkomplexitet + frekvent byte‚Äù.

Lokala admin: Windows LAPS f√∂r unika hemligheter.

Exempel: RDP till√•ts endast f√∂r gruppen G_Admin via User Rights Assignment. L√∂senordspolicyn kr√§ver minst 15 tecken; gruppen G_H√∂gRisk f√•r dessutom FGPP med l√•gniv√•-tr√∂skel och obligatorisk MFA f√∂r alla molnappar.

### 4.2.4 Beh√∂righeter och arv i Linux och Windows

B√•da v√§rldarna beh√∂ver svara p√• samma fr√•ga: vem f√•r vad, och hur √§rvs det vidare? Svaren ser olika ut i verktyg ‚Äì men logiken rimmar.

Linux ‚Äì DAC, grupper och ACL
Linux bygger p√• DAC (Discretionary Access Control): √§gare, grupp, andra med r√§ttigheterna r/w/x. F√∂r kataloger betyder x ‚Äúf√• g√• igenom/ang√∂ra‚Äù, w ‚Äúskapa/ta bort i katalogen‚Äù. setgid p√• kataloger g√∂r att nya filer f√•r katalogens grupp (bra f√∂r gemensamma tr√§d). sticky bit p√• gemensamma ‚Äúinl√§mningskorgar‚Äù g√∂r att man inte kan ta bort andras filer. POSIX-ACL kompletterar med finare r√§ttigheter och default-ACL som √§rvs ned√•t n√§r nya objekt skapas. sudo ger sp√•rbar eskalering till administrativa kommandon; polkit och Linux capabilities kan ge mer granul√§r kontroll per tj√§nst.

Windows ‚Äì NTFS-ACL och arv
NTFS anv√§nder ACL (Access Control List) med ACE-poster (Allow/Deny) f√∂r anv√§ndare och grupper. R√§ttigheter √§rvs ned√•t i tr√§d om inte arv bryts. √Ñgarskap styr r√§tten att ta √∂ver/√§ndra r√§ttigheter. Effektiv r√§ttighet blir summan av tilldelade Allow minus eventuella Deny (som vinner). Skillnad mot Linux √§r att arvet √§r explicit synligt och att √§rvda poster skiljs fr√•n direkta poster. I n√§tutdelningar ‚Äúmultipliceras‚Äù share-r√§ttigheter med NTFS ‚Äì den mest begr√§nsande g√§ller.

Gemensam n√§mnare ‚Äì grupper som spr√•k
I b√•da milj√∂er blir grupper det praktiska st√§llet d√§r RBAC uttrycks. P√• Linux kopplas grupper till √§garskap/ACL; i Windows kopplas grupper till NTFS-ACL (och i dom√§nen till GPO och User Rights). Arv g√∂r att r√§ttigheten f√∂ljer strukturen, inte manuella undantag.

F√∂rtydligande (sammanfattning):

- Linux: √§gare/grupp/andra, setgid/sticky, default-ACL; sudo f√∂r sp√•rbar eskalering.
- Windows: NTFS-ACL med arv och √§garskap; share √ó NTFS ger effektiv r√§tt.
- B√•da: grupper uttrycker roll; l√•t arv g√∂ra det tunga lyftet.

Linux: √§gare/grupp/andra, setgid/sticky, default-ACL; sudo f√∂r sp√•rbar eskalering.

Windows: NTFS-ACL med arv och √§garskap; share √ó NTFS ger effektiv r√§tt.

B√•da: grupper uttrycker roll; l√•t arv g√∂ra det tunga lyftet.

Exempel: Ett √§mnestr√§d p√• filservern har setgid och default-ACL som ger ‚ÄúLarare‚Äù write. I NTFS-v√§rlden motsvaras detta av en √§rvd Allow-Modify f√∂r gruppen G_Larare p√• rotmappen. I b√•da fall r√§cker det att l√§gga en ny l√§rare i r√§tt grupp ‚Äì inget handpill i djupt liggande mappar.

### 4.2.5 Vanliga m√∂nster och missf√∂rst√•nd

Ett par m√∂nster √•terkommer oavsett plattform: minsta m√∂jliga r√§ttighet (ge bara det som kr√§vs), separation of duties (dela ansvar s√• att ingen ensam kan skapa och godk√§nna sin egen √•tkomst), och f√∂ruts√§gbar arvsv√§g (r√§ttigheter definieras h√∂gt upp och √§rvs ned). Missf√∂rst√•nd uppst√•r ofta n√§r individuella undantag landar p√• objekt l√•ngt ner i ett tr√§d ‚Äì de fungerar idag, men bryter ihop imorgon. Ett annat √§r att blanda ihop OS-r√§ttigheter (vem f√•r logga in) med data-r√§ttigheter (vad f√•r l√§sas/√§ndras); de lever i olika lager.

F√∂rtydligande (sammanfattning):

- Satsa p√• gruppbaserad beh√∂righet och arv; undvik manuella ‚Äúlappar och lag‚Äù.
- Separera logon-r√§ttigheter fr√•n filr√§ttigheter i tanke och praktik.
- L√•t accounting (loggar) bevisa efterlevnad och underl√§tta fels√∂kning.

Satsa p√• gruppbaserad beh√∂righet och arv; undvik manuella ‚Äúlappar och lag‚Äù.

Separera logon-r√§ttigheter fr√•n filr√§ttigheter i tanke och praktik.

L√•t accounting (loggar) bevisa efterlevnad och underl√§tta fels√∂kning.

Exempel: Ett enskilt ‚ÄúDeny‚Äù p√• en djupt liggande mapp ‚Äúl√•ser ute‚Äù en l√§rare of√∂rutsett. Efter st√§dning tillbaka till rent arv (bara Allow via grupp) f√∂rsvinner sidoeffekterna och fels√∂kning blir begriplig.

### 

### üìå Kontrollfr√•gor

- Beskriv AAA (Authentication, Authorization, Accounting) och ge ett konkret exempel p√• varje del.
- Vad skiljer RBAC fr√•n ABAC, och n√§r √§r ABAC s√§rskilt anv√§ndbart?
- Vilka MF-metoder r√§knas som phishing-resistenta, och varf√∂r?
- Vad √§r User Rights Assignment och hur skiljer det sig fr√•n filr√§ttigheter?
- N√§r passar FGPP (Fine-Grained Password Policies), och varf√∂r f√∂redras l√•nga l√∂senfraser + MFA framf√∂r t√§ta tv√•ngsbyten?
- F√∂rklara setgid och sticky bit p√• kataloger i Linux och hur de hj√§lper i gemensamma mappar.
- Hur fungerar arv i NTFS-ACL, och varf√∂r b√∂r Deny anv√§ndas sparsamt?
- Varf√∂r leder individuella undantag ofta till of√∂ruts√§gbart beteende √∂ver tid?
- Ge ett scenario d√§r ABAC (t.ex. enhets-compliance) p√•verkar √•tkomstbeslutet.
- Vilka loggk√§llor beh√∂vs f√∂r Accounting n√§r man vill kunna sp√•ra ‚Äúvem gjorde vad, n√§r, fr√•n var‚Äù?

Beskriv AAA (Authentication, Authorization, Accounting) och ge ett konkret exempel p√• varje del.

Vad skiljer RBAC fr√•n ABAC, och n√§r √§r ABAC s√§rskilt anv√§ndbart?

Vilka MF-metoder r√§knas som phishing-resistenta, och varf√∂r?

Vad √§r User Rights Assignment och hur skiljer det sig fr√•n filr√§ttigheter?

N√§r passar FGPP (Fine-Grained Password Policies), och varf√∂r f√∂redras l√•nga l√∂senfraser + MFA framf√∂r t√§ta tv√•ngsbyten?

F√∂rklara setgid och sticky bit p√• kataloger i Linux och hur de hj√§lper i gemensamma mappar.

Hur fungerar arv i NTFS-ACL, och varf√∂r b√∂r Deny anv√§ndas sparsamt?

Varf√∂r leder individuella undantag ofta till of√∂ruts√§gbart beteende √∂ver tid?

Ge ett scenario d√§r ABAC (t.ex. enhets-compliance) p√•verkar √•tkomstbeslutet.

Vilka loggk√§llor beh√∂vs f√∂r Accounting n√§r man vill kunna sp√•ra ‚Äúvem gjorde vad, n√§r, fr√•n var‚Äù?


### üîó F√∂rdjupningsl√§nkar

- NIST SP 800-63-3 ‚Äì Digital Identity Guidelines: https://pages.nist.gov/800-63-3/

NIST SP 800-63-3 ‚Äì Digital Identity Guidelines: https://pages.nist.gov/800-63-3/

- FIDO Alliance ‚Äì Overview (passkeys/s√§kerhetsnycklar): https://fidoalliance.org/overview/

FIDO Alliance ‚Äì Overview (passkeys/s√§kerhetsnycklar): https://fidoalliance.org/overview/

- W3C ‚Äì Web Authentication (WebAuthn) Level 2: https://www.w3.org/TR/webauthn-2/

W3C ‚Äì Web Authentication (WebAuthn) Level 2: https://www.w3.org/TR/webauthn-2/

- Microsoft Learn ‚Äì User Rights Assignment (Group Policy): https://learn.microsoft.com/windows/security/threat-protection/security-policy-settings/user-rights-assignment

Microsoft Learn ‚Äì User Rights Assignment (Group Policy): https://learn.microsoft.com/windows/security/threat-protection/security-policy-settings/user-rights-assignment

- Microsoft Learn ‚Äì Fine-Grained Password Policies (FGPP): https://learn.microsoft.com/windows-server/identity/ad-ds/manage/component-updates/fine-grained-password-policies

Microsoft Learn ‚Äì Fine-Grained Password Policies (FGPP): https://learn.microsoft.com/windows-server/identity/ad-ds/manage/component-updates/fine-grained-password-policies

- Microsoft Learn ‚Äì Windows LAPS (√∂versikt): https://learn.microsoft.com/windows-server/identity/laps/laps-overview

Microsoft Learn ‚Äì Windows LAPS (√∂versikt): https://learn.microsoft.com/windows-server/identity/laps/laps-overview

- man7 ‚Äì POSIX ACL (acl(5)): https://man7.org/linux/man-pages/man5/acl.5.html

man7 ‚Äì POSIX ACL (acl(5)): https://man7.org/linux/man-pages/man5/acl.5.html

- man7 ‚Äì chmod(1) (filr√§ttigheter): https://man7.org/linux/man-pages/man1/chmod.1.html

man7 ‚Äì chmod(1) (filr√§ttigheter): https://man7.org/linux/man-pages/man1/chmod.1.html

- sudoers manual (kontrollerad eskalering): https://www.sudo.ws/docs/man/sudoers.man/

sudoers manual (kontrollerad eskalering): https://www.sudo.ws/docs/man/sudoers.man/

- polkit ‚Äì PolicyKit-dokumentation: https://www.freedesktop.org/software/polkit/docs/latest/

polkit ‚Äì PolicyKit-dokumentation: https://www.freedesktop.org/software/polkit/docs/latest/

### 

### ‚úçÔ∏è Egna anteckningar

‚Ä¶


