# 3. N√§tverksadministration

## 3.2 Verktyg: ping, traceroute, ipconfig, netstat etc.

### 3.2.1 Varf√∂r dessa verktyg?

N√§r n√•got ‚Äúinte funkar‚Äù g√§ller det att snabbt avg√∂ra var felet finns: n√§tl√§nk, adressering, namnuppl√∂sning, routing eller sj√§lva tj√§nsten/porten. De klassiska verktygen ‚Äì ping, traceroute/tracert, ipconfig (Windows) / ip (Linux), netstat/ss, samt nslookup/dig, arp/route och vid behov Wireshark/tcpdump ‚Äì l√•ter dig testa kedjan steg f√∂r steg. Tanken √§r att bekr√§fta det som fungerar och ringa in det f√∂rsta lagret d√§r det slutar fungera.

F√∂rtydligande (sammanfattning):

- L√§nk & IP: ipconfig/ip, ping gateway.
- Namn: nslookup/dig.
- V√§gval: tracert/traceroute.
- Tj√§nst/port: netstat/ss lokalt, test-netconnection (Win) eller nc (Linux).
- Djupanalys: Wireshark/tcpdump.

L√§nk & IP: ipconfig/ip, ping gateway.

Namn: nslookup/dig.

V√§gval: tracert/traceroute.

Tj√§nst/port: netstat/ss lokalt, test-netconnection (Win) eller nc (Linux).

Djupanalys: Wireshark/tcpdump.

Exempel: En elev s√§ger ‚Äúinternet √§r nere‚Äù. Du pingar skolans gateway (OK), pingar 8.8.8.8 (OK), men nslookup google.com faller. Slutsats: problemet √§r DNS, inte ‚Äúinternet‚Äù.

### 3.2.2 ping ‚Äì n√•r vi fram √∂verhuvudtaget?

ping anv√§nder ICMP (echo request/reply) f√∂r att m√§ta n√•rbarhet, latens och f√∂rlust. B√∂rja n√§ra: ping egen IP, gateway, sedan extern IP. T√§nk p√• att brandv√§ggar kan blockera ICMP trots att applikationer fungerar ‚Äì ping √§r allts√• ingen garanti f√∂r att en tj√§nst √§r uppe, bara att v√§gen √§r √∂ppen f√∂r ICMP.

F√∂rtydligande (sammanfattning):

- Windows: ping 1.1.1.1, ping -4/-6, ping -t (kontinuerlig).
- Linux: ping -c 10 1.1.1.1, ping -I eth0 10.0.0.1.
- Tolkning: h√∂g latens/jitter och paketf√∂rlust ‚Üí n√§tproblem; 100 % f√∂rlust kan vara blockerat ICMP.

Windows: ping 1.1.1.1, ping -4/-6, ping -t (kontinuerlig).

Linux: ping -c 10 1.1.1.1, ping -I eth0 10.0.0.1.

Tolkning: h√∂g latens/jitter och paketf√∂rlust ‚Üí n√§tproblem; 100 % f√∂rlust kan vara blockerat ICMP.

Exempel: ping 10.20.0.1 (gateway) fungerar men ping 8.8.8.8 tappar paket ‚Äì felet ligger troligen ‚Äúut√•t‚Äù, mellan gateway och internet.

### 3.2.3 traceroute / tracert ‚Äì var tar trafiken v√§gen?

traceroute (Linux) / tracert (Windows) visar varje hopp p√• v√§gen till ett m√•l genom att successivt √∂ka TTL och l√§sa svaren. Anv√§nds f√∂r att se var trafiken stannar eller g√•r omv√§gar. Stj√§rnor * betyder att ett hopp inte svarade (kan bero p√• brandv√§gg eller policys). Windows anv√§nder som standard ICMP, Linux ofta UDP ‚Äì v√§xla vid behov (traceroute -I f√∂r ICMP).

F√∂rtydligande (sammanfattning):

- Windows: tracert -d 8.8.8.8 (-d hoppar √∂ver DNS-uppl√∂sning).
- Linux: traceroute -I 8.8.8.8, eller mtr f√∂r livevy.
- L√§sning: privata IP i mitten = NAT/operat√∂rsled; stopp mellan hop N och N+1 = trolig blockering/fel d√§r.

Windows: tracert -d 8.8.8.8 (-d hoppar √∂ver DNS-uppl√∂sning).

Linux: traceroute -I 8.8.8.8, eller mtr f√∂r livevy.

L√§sning: privata IP i mitten = NAT/operat√∂rsled; stopp mellan hop N och N+1 = trolig blockering/fel d√§r.

Exempel: tracert intranet.skolan.se stannar vid brandv√§ggen ‚Üí kontrollera NAT/brandv√§ggsregler och intern rutt mot DMZ.

### 3.2.4 ipconfig (Windows) / ip (Linux) ‚Äì grunder och snabbreng√∂ring

H√§r ser du adressering, gateway, DNS, suffix, DHCP-status och l√§nkl√§ge. I Windows anv√§nder du ipconfig, i Linux moderna ip-verktyget (ers√§tter ifconfig).

F√∂rtydligande (sammanfattning):

- Windows: ipconfig /all (allt), /release ‚Üí /renew (DHCP), /flushdns (t√∂m cache), /displaydns (visa cache).
- Linux: ip addr, ip link, ip route, resolvectl status (systemd-baserat).
- Snabbkoll: Har interfacet IP? R√§tt VLAN? R√§tt gateway/DNS?

Windows: ipconfig /all (allt), /release ‚Üí /renew (DHCP), /flushdns (t√∂m cache), /displaydns (visa cache).

Linux: ip addr, ip link, ip route, resolvectl status (systemd-baserat).

Snabbkoll: Har interfacet IP? R√§tt VLAN? R√§tt gateway/DNS?

Exempel: Klienten har 169.254.x.x (APIPA) ‚Üí DHCP n√•r inte fram. Kontrollera DHCP relay och VLAN-tillh√∂righet p√• porten.

### 3.2.5 netstat / ss ‚Äì lyssnar tj√§nsten, och vem pratar den med?

netstat (Windows) och ss (Linux) visar lyssnande portar och aktiva anslutningar. Perfekt f√∂r att verifiera att en server verkligen lyssnar p√• r√§tt port, eller f√∂r att hitta vilket program som h√•ller en port.

F√∂rtydligande (sammanfattning):

- Windows: netstat -ano (alla + PID), netstat -anob (kr√§ver admin). Matcha PID med tasklist /FI "PID eq 1234".
- Linux: ss -tulpen (TCP/UDP, lyssnar, process, port, n√§t).
- Tolkning: ‚ÄúLISTEN‚Äù finns lokalt men klienten n√•r inte ‚Üí sannolikt brandv√§gg/routing mellan.

Windows: netstat -ano (alla + PID), netstat -anob (kr√§ver admin). Matcha PID med tasklist /FI "PID eq 1234".

Linux: ss -tulpen (TCP/UDP, lyssnar, process, port, n√§t).

Tolkning: ‚ÄúLISTEN‚Äù finns lokalt men klienten n√•r inte ‚Üí sannolikt brandv√§gg/routing mellan.

Exempel: Webbservern svarar inte externt. netstat -ano visar LISTENING :443 p√• servern ‚Üí felet ligger troligen i brandv√§ggen eller DNAT.

### 3.2.6 nslookup / dig ‚Äì namnen som allt h√§nger p√•

DNS √§r beroende f√∂r n√§stan alla applikationer. nslookup (Windows/Linux) och dig (Linux) l√•ter dig fr√•ga exakt vilken resolver du vill, och vilken posttyp du beh√∂ver (A/AAAA/MX/SRV).

F√∂rtydligande (sammanfattning):

- Snabbtest: nslookup files.skolan.local 10.40.0.10 eller dig A example.com @1.1.1.1.
- F√∂rdjupning: nslookup -type=SRV _ldap._tcp.skolan.local eller dig +trace example.com.
- Symptom: Namn funkar internt men inte externt ‚Üí split-horizon/forwarder-fr√•ga.

Snabbtest: nslookup files.skolan.local 10.40.0.10 eller dig A example.com @1.1.1.1.

F√∂rdjupning: nslookup -type=SRV _ldap._tcp.skolan.local eller dig +trace example.com.

Symptom: Namn funkar internt men inte externt ‚Üí split-horizon/forwarder-fr√•ga.

Exempel: nslookup intranet.skolan.se svarar med publik IP, men intern √•tkomst kr√§ver DMZ-IP ‚Üí l√∂s via intern A-post eller hairpin NAT (se 2.4).

### 3.2.7 arp / route ‚Äì lager-2-cache och standardv√§gar

arp visar MAC‚ÜîIP-cache f√∂r IPv4 (Linux: ip neigh; f√∂r IPv6 anv√§nds ND). route print (Windows) / ip route (Linux) visar routingtabellen ‚Äì kolla s√§rskilt default gateway och eventuella specifika statiska rutter som sk√§r av trafiken.

F√∂rtydligande (sammanfattning):

- ARP/ND: saknas uppslag till gatewayens MAC ‚Üí ingen L2-v√§g (VLAN/port?).
- Default: dubbla default-rutter kan skapa slumpm√§ssig eller asymmetrisk trafik.
- Specifika rutter: en felaktig /32 kan ‚Äústj√§la‚Äù ett m√•l.

ARP/ND: saknas uppslag till gatewayens MAC ‚Üí ingen L2-v√§g (VLAN/port?).

Default: dubbla default-rutter kan skapa slumpm√§ssig eller asymmetrisk trafik.

Specifika rutter: en felaktig /32 kan ‚Äústj√§la‚Äù ett m√•l.

Exempel: route print visar tv√• default gateways (WLAN + Ethernet). Klienten skickar ibland via fel l√§nk ‚Üí st√§ng av ena interfacet eller prioritera r√§tt.

### 3.2.8 Wireshark / tcpdump ‚Äì n√§r du beh√∂ver se paketen

N√§r verktygen ovan inte r√§cker f√•ngar du paket. Wireshark (GUI) √§r l√§tt att filtrera i, tcpdump (CLI) √§r perfekt via SSH eller p√• server/brandv√§gg. F√•nga s√• n√§ra felet som m√∂jligt och filtrera sn√§vt (host/port/protokoll) f√∂r att undvika brus, och t√§nk p√• sekretess n√§r du f√•ngar riktig trafik.

F√∂rtydligande (sammanfattning):

- tcpdump: tcpdump -i eth0 host 10.40.0.50 and port 443.
- Wireshark: filter ‚Äúip.addr==10.40.0.50 && tcp.port==443‚Äù.
- Tolkning: SYN utan SYN/ACK ‚Üí block/ingen lyssnare; trev√§gshandskak komplett men app felar ‚Üí applikationslager.

tcpdump: tcpdump -i eth0 host 10.40.0.50 and port 443.

Wireshark: filter ‚Äúip.addr==10.40.0.50 && tcp.port==443‚Äù.

Tolkning: SYN utan SYN/ACK ‚Üí block/ingen lyssnare; trev√§gshandskak komplett men app felar ‚Üí applikationslager.

Exempel: Klient n√•r serverns 443 men inloggning snurrar. F√•ngst visar TLS-fel (f√∂r gammal cipher). √Ötg√§rd: uppdatera serverns TLS-policy/klient.

### 3.2.9 Ett snabbt fels√∂kningsrecept (kedjan fr√•n klient till tj√§nst)

Snabb affisch (l√§nk ‚Üí app): IP ‚Üí Gateway ‚Üí Extern IP ‚Üí DNS ‚Üí Rutt ‚Üí Port/tj√§nst ‚Üí Applikation.

B√∂rja lokalt och r√∂r dig ut√•t. S√§kerst√§ll l√§nk ‚Üí IP ‚Üí gateway ‚Üí namn ‚Üí v√§g ‚Üí port ‚Üí applikation. Bygg vana att dokumentera varje steg (kommando + resultat), s√• blir √•terkopplingen till anv√§ndaren och kollegor rak.

F√∂rtydligande (sammanfattning):

- ipconfig/ip (har vi IP, r√§tt VLAN/gateway/DNS?).
- ping gateway (lokal n√•barhet).
- ping extern IP (internet utan DNS).
- nslookup/dig (namnuppl√∂sning).
- tracert/traceroute (var stannar trafiken?).
- netstat/ss (lyssnar servern? portar?).
- Wireshark/tcpdump (vid behov).

ipconfig/ip (har vi IP, r√§tt VLAN/gateway/DNS?).

ping gateway (lokal n√•barhet).

ping extern IP (internet utan DNS).

nslookup/dig (namnuppl√∂sning).

tracert/traceroute (var stannar trafiken?).

netstat/ss (lyssnar servern? portar?).

Wireshark/tcpdump (vid behov).

Exempel: Elev kan inte n√• files.skolan.local. 1) IP OK. 2) Ping gateway OK. 3) Ping 10.40.0.50 OK. 4) nslookup files.skolan.local ger fel IP. 5) Uppdatera intern DNS ‚Üí problemet l√∂st utan att ‚Äúr√∂ra n√§tet‚Äù.

### 

### üìå Kontrollfr√•gor

- Vilken kedja av tester k√∂r du f√∂r att skilja p√• DNS-fel och ‚Äúinternet ligger nere‚Äù?
- Vad s√§ger ping dig om v√§gen, och vad s√§ger det inte?
- N√§r anv√§nder du tracert/traceroute -d och varf√∂r kan * visas i utskriften?
- Vilken information letar du efter i ipconfig /all respektive ip route?
- Vad betyder en 169.254.x.x-adress och vilka tv√• saker kontrollerar du f√∂rst?
- Hur anv√§nder du netstat -ano eller ss -tulpen f√∂r att verifiera att en tj√§nst verkligen lyssnar?
- Hur testar du namnuppl√∂sning mot en specifik resolver med nslookup/dig?
- N√§r v√§ljer du paketf√•ngst (Wireshark/tcpdump), och vilket minimifilter s√§tter du f√∂rst?
- Vilket problem kan dubbla default-gateways orsaka och hur ser du det?
- Ge ett exempel d√§r traceroute visar r√§tt v√§g men appen √§nd√• inte fungerar ‚Äì vad unders√∂ker du d√•?

Vilken kedja av tester k√∂r du f√∂r att skilja p√• DNS-fel och ‚Äúinternet ligger nere‚Äù?

Vad s√§ger ping dig om v√§gen, och vad s√§ger det inte?

N√§r anv√§nder du tracert/traceroute -d och varf√∂r kan * visas i utskriften?

Vilken information letar du efter i ipconfig /all respektive ip route?

Vad betyder en 169.254.x.x-adress och vilka tv√• saker kontrollerar du f√∂rst?

Hur anv√§nder du netstat -ano eller ss -tulpen f√∂r att verifiera att en tj√§nst verkligen lyssnar?

Hur testar du namnuppl√∂sning mot en specifik resolver med nslookup/dig?

N√§r v√§ljer du paketf√•ngst (Wireshark/tcpdump), och vilket minimifilter s√§tter du f√∂rst?

Vilket problem kan dubbla default-gateways orsaka och hur ser du det?

Ge ett exempel d√§r traceroute visar r√§tt v√§g men appen √§nd√• inte fungerar ‚Äì vad unders√∂ker du d√•?

### 

### üîó F√∂rdjupningsl√§nkar

- Microsoft Learn ‚Äì Windows-kommandon (√∂versikt): https://learn.microsoft.com/windows-server/administration/windows-commands/windows-commands
- ping (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/ping
- tracert (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/tracert
- ipconfig (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/ipconfig
- netstat (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/netstat
- Test-NetConnection (PowerShell): https://learn.microsoft.com/powershell/module/nettcpip/test-netconnection
- ip (Linux, man-sida): https://man7.org/linux/man-pages/man8/ip.8.html
- ss (Linux, man-sida): https://man7.org/linux/man-pages/man8/ss.8.html
- traceroute (Linux, man-sida): https://man7.org/linux/man-pages/man8/traceroute.8.html
- Wireshark ‚Äì User Guide: https://www.wireshark.org/docs/wsug_html_chunked/
- tcpdump ‚Äì man-sida: https://www.tcpdump.org/manpages/tcpdump.1.html
- dig ‚Äì BIND9-dokumentation: https://bind9.readthedocs.io/en/v9.18.0/dig.html

Microsoft Learn ‚Äì Windows-kommandon (√∂versikt): https://learn.microsoft.com/windows-server/administration/windows-commands/windows-commands

ping (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/ping

tracert (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/tracert

ipconfig (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/ipconfig

netstat (Windows): https://learn.microsoft.com/windows-server/administration/windows-commands/netstat

Test-NetConnection (PowerShell): https://learn.microsoft.com/powershell/module/nettcpip/test-netconnection

ip (Linux, man-sida): https://man7.org/linux/man-pages/man8/ip.8.html

ss (Linux, man-sida): https://man7.org/linux/man-pages/man8/ss.8.html

traceroute (Linux, man-sida): https://man7.org/linux/man-pages/man8/traceroute.8.html

Wireshark ‚Äì User Guide: https://www.wireshark.org/docs/wsug_html_chunked/

tcpdump ‚Äì man-sida: https://www.tcpdump.org/manpages/tcpdump.1.html

dig ‚Äì BIND9-dokumentation: https://bind9.readthedocs.io/en/v9.18.0/dig.html

### 

### ‚úçÔ∏è Egna anteckningar

‚Ä¶



