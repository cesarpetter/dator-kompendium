# 4. S√§kerhet och √∂vervakning

## 4.1 N√§tverkss√§kerhetens grunder

### 4.1.1 Grundid√©er: lager, r√§ttigheter och synlighet

N√§tverkss√§kerhet handlar i grunden om att minska konsekvensen n√§r n√•got g√•r fel, inte om att garantera att inget n√•gonsin h√§nder. Tv√• id√©er ramar in allt annat: f√∂rsvar i flera lager (defense in depth) och minsta m√∂jliga r√§ttighet (least privilege). Lager-t√§nket g√∂r att ett enskilt fel ‚Äì en s√•rbar klient, ett l√§ckt l√∂senord, en missad uppdatering ‚Äì inte automatiskt blir ett stort driftstopp. R√§ttighetsprincipen g√∂r att ett komprometterat konto eller en felkonfigurerad tj√§nst inte f√•r mer makt √§n vad den faktiskt beh√∂ver. Allt detta st√•r och faller med synlighet: utan loggar, larm och m√§tningar vet man varken vad som h√§nde eller om √•tg√§rden fungerade.

I praktiken b√∂rjar s√§kerhetsarbetet med tre fr√•gor: Vad skyddas? Mot vad? Hur m√§rks det? Tillg√•ngar (elevdata, l√§rarmaterial, administration), hot (misstag, skadlig kod, obeh√∂rig √•tkomst) och telemetri (loggar, larm, m√§tv√§rden). N√§r det √§r definierat blir prioriteringen enklare: segmentering (VLAN/zoner), uppdateringar, stark identitet (MFA, gruppbaserad √•tkomst), baspolicys (klient/servrar med brandv√§gg p√•) och loggning som faktiskt l√§ses ger ofta mest effekt.

F√∂rtydligande (sammanfattning):

- Lager: sm√• fel blir inte stora.
- R√§ttigheter: konton/tj√§nster har bara det de beh√∂ver.
- Synlighet: utan logg/larm finns ingen s√§kerhet i praktiken.
- Prioritering: segmentering, patchning, stark identitet ger h√∂g ‚Äútr√§ff per timme‚Äù.

Lager: sm√• fel blir inte stora.

R√§ttigheter: konton/tj√§nster har bara det de beh√∂ver.

Synlighet: utan logg/larm finns ingen s√§kerhet i praktiken.

Prioritering: segmentering, patchning, stark identitet ger h√∂g ‚Äútr√§ff per timme‚Äù.

Exempel: Elevklienter och serversystem ligger i olika VLAN. √Ñven om en elevdator infekteras kan skadlig kod inte prata direkt med servern ‚Äì brandv√§gg och routingregler st√•r i v√§gen. H√§ndelsen syns i loggarna och kan hanteras innan den sprider sig.

### 4.1.2 CIA-triaden

CIA-triaden beskriver tre m√•l: konfidentialitet (bara r√§tt mottagare kan l√§sa), integritet (data √§r of√∂r√§ndrad) och tillg√§nglighet (tj√§nsten fungerar n√§r den beh√∂vs). Varje kontroll b√∂r kunna motiveras med vilket C, I eller A den st√∂ttar. Kryptering och beh√∂righet skyddar C, signering och checksummer skyddar I, redundans och kapacitetsplanering skyddar A.

### 4.1.3 Brandv√§ggar: klassisk ‚Üí NGFW (Next-Generation Firewall)

Brandv√§ggar uttrycker vad som √§r till√•tet mellan zoner; allt annat nekas. En klassisk, stateful brandv√§gg arbetar fr√§mst p√• lager 3/4: k√§ll-/m√•l-IP, portar och protokoll, och h√•ller reda p√• anslutningars tillst√•nd (t.ex. TCP SYN/ACK). Det r√§cker l√•ngt f√∂r k√§nda fl√∂den (‚Äúserver X f√•r prata TCP/443 ut‚Äù), men blir trubbigt n√§r m√•nga applikationer delar samma portar.

En NGFW (Next-Generation Firewall) l√§gger till lager-7-f√∂rst√•else. Den kan identifiera applikationer oavsett portar, koppla regler till anv√§ndaridentitet (via t.ex. AD/Entra), och utf√∂ra inneh√•llsinspektion. I praktiken inneb√§r det moduler som IPS (Intrusion Prevention System), URL-/webbfiltrering, m√∂jlighet till TLS-inspektion (dekryptera, kontrollera, kryptera om), sandboxning av misst√§nkta filer samt fl√∂de av threat intelligence. Po√§ngen √§r inte fler ‚Äúknappar‚Äù, utan att policyn kan uttryckas n√§rmare verksamheten: till√•t r√§tt tj√§nst f√∂r r√§tt grupp, blockera os√§kra m√∂nster.

F√∂rtydligande (sammanfattning):

- Stateful brandv√§gg: IP/port/protokoll + tillst√•nd; enkel och snabb.
- NGFW: app-igenk√§nning (lager 7), identitetsmedvetna regler, IPS, URL-filter, ev. TLS-inspektion, sandboxning, hotfl√∂den.
- Att t√§nka p√•: prestanda (s√§rskilt TLS-inspektion), integritet/juridik, kompatibilitet (certifikat-pinning) och tydliga undantag.

Stateful brandv√§gg: IP/port/protokoll + tillst√•nd; enkel och snabb.

NGFW: app-igenk√§nning (lager 7), identitetsmedvetna regler, IPS, URL-filter, ev. TLS-inspektion, sandboxning, hotfl√∂den.

Att t√§nka p√•: prestanda (s√§rskilt TLS-inspektion), integritet/juridik, kompatibilitet (certifikat-pinning) och tydliga undantag.

Exempel: I en klassisk modell blir policyn ‚Äútill√•t TCP/443 ut‚Äù, vilket i praktiken √∂ppnar f√∂r ‚Äúallt som talar HTTPS‚Äù. Med NGFW kan policyn i st√§llet s√§ga ‚Äútill√•t Microsoft Update och ett f√•tal samarbetsverktyg f√∂r Personal, men blockera ok√§nda TLS-appar och fildelning f√∂r Elever‚Äù ‚Äì √§ven om allt anv√§nder 443.

### 4.1.4 IDS/IPS (Intrusion Detection/Prevention System) ‚Äì och samspelet med NGFW

IDS/IPS kompletterar brandv√§ggar genom att fokusera p√• beteenden och m√∂nster i trafiken snarare √§n bara k√§llor och portar. En NIDS (Network Intrusion Detection System) observerar trafik i n√§tet ‚Äì ofta via SPAN (Switched Port Analyzer) eller en TAP (Test Access Point) ‚Äì och ser fl√∂den mellan system (‚Äúnorth-south‚Äù mot internet och ‚Äúeast-west‚Äù mellan zoner). En HIDS (Host Intrusion Detection System) tittar inne i v√§rden (processer, loggar, fil√§ndringar) och f√•ngar s√•dant som inte alltid syns p√• n√§tet.

Detekteringsmetoderna √§r tv√•: signaturbaserad detektering j√§mf√∂r mot k√§nda m√∂nster (snabb och exakt f√∂r det k√§nda), medan anomalibas letar avvikelser fr√•n ‚Äúnormal‚Äù trafik (b√§ttre chans p√• ok√§nda hot, men kr√§ver inl√§rning och kan ge fler falsklarm). K√∂rs motorn inline blir den IPS: samma analys, men med m√∂jlighet att blockera eller reseta misst√§nkta f√∂rbindelser i realtid; k√∂rs den vid sidan om (out-of-band) √§r rollen att larma.

Placering och signal. Vid gr√§nsen mot internet f√•ngas angrepp utifr√•n, men mycket verksamhetslogik passerar internt mellan klient- och serverzoner; d√§r ger en NIDS-sensor p√• r√§tt l√§nk h√∂g signal. Kryptering (t.ex. TLS) begr√§nsar inneh√•llsinsyn; d√• blir metadata (tidsm√∂nster, anslutningsfrekvens, k√§nda dom√§ner/IP:er) och HIDS-telemetri extra v√§rdefullt. Ofta anv√§nds flera sensorer f√∂r att skapa sammanhang: NIDS ser ov√§ntade anslutningar, HIDS ser onormala processer, och loggk√§llor (AD, brandv√§gg, proxy) fyller i tidslinjen.

NGFW och IDS/IPS i samspel. M√•nga NGFW inneh√•ller en IPS-motor. Det ger f√∂rdelen att stoppa v√§lk√§nda m√∂nster i brandv√§ggens policyfl√∂de. Samtidigt beh√•ller friliggande NIDS/HIDS v√§rde: de kan placeras p√• andra l√§nkar (t.ex. mellan klient- och serverzon) och f√•nga east-west-r√∂relser som inte passerar brandv√§ggens kant, eller ge second opinion utan att riskera falskpositiv blockering. En vanlig v√§g √§r att b√∂rja i detekteringsl√§ge och blockera f√∂rst n√§r regler har h√∂g tillit ‚Äì s√§rskilt p√• systemkritiska l√§nkar.

F√∂rtydligande (sammanfattning):

- NIDS/HIDS: n√§t- respektive v√§rd-perspektiv; kompletterar varandra.
- Signatur vs anomali: k√§nt-snabbt kontra ok√§nt-uppt√§ckbart.
- Inline vs out-of-band: blockera vs larma.
- Samspelet: NGFW-IPS stoppar vid kanten; NIDS/HIDS ger djup och kontext internt.

NIDS/HIDS: n√§t- respektive v√§rd-perspektiv; kompletterar varandra.

Signatur vs anomali: k√§nt-snabbt kontra ok√§nt-uppt√§ckbart.

Inline vs out-of-band: blockera vs larma.

Samspelet: NGFW-IPS stoppar vid kanten; NIDS/HIDS ger djup och kontext internt.

Exempel: En serverzon visar pl√∂tsliga utg√•ende anslutningar mot ovanliga m√•l. NIDS (via TAP) larmar f√∂r ‚Äúrare outbound‚Äù och HIDS p√• samma server rapporterar nyskapade processer i ett ovanligt katalogtr√§d. Brandv√§ggen s√§tter en tillf√§llig block p√• utg√•ende trafik fr√•n den servern (h√∂g-tillitsregel i IPS-l√§get), och korrelation med AD-loggar visar ett l√§ckt tj√§nstkonto som sp√§rras och roteras.

### 4.1.5 Honeypots och honeytokens

Honeypots och deception skapar medvetna ‚Äúm√•l‚Äù som ska vara tysta i normal drift. Po√§ngen √§r inte att ‚Äúlocka angripare f√∂r sport‚Äù, utan att skapa tidig varning och telemetri i zoner d√§r man i √∂vrigt vill se s√• lite trafik som m√∂jligt. En enkel variant √§r en honeytoken (falsk uppgift/fil) som larmar n√§r den l√§ses.

F√∂rtydligande (sammanfattning):

- Syfte: blixtlampa ‚Äì inte produktion.
- Placering: i zoner d√§r legitim kontakt √§r s√§llsynt.
- √Ötg√§rd: tydlig √§gare och process n√§r det blinkar.

Syfte: blixtlampa ‚Äì inte produktion.

Placering: i zoner d√§r legitim kontakt √§r s√§llsynt.

√Ötg√§rd: tydlig √§gare och process n√§r det blinkar.

Exempel: En ‚Äútyst‚Äù filserver-alias annonseras internt. All aktivitet dit larmar ‚Äì signal som annars hade drunknat bland normaltrafik.

### 4.1.6 S√§kerhet i VLAN-design

VLAN √§r inte bara ordning och adressplan; det √§r ett s√§kerhetsverktyg. N√§r zoner och fl√∂den uttrycks i VLAN och routing/ACL minskar risken att ‚Äútillf√§lliga l√∂sningar‚Äù skapar genv√§gar.

√Öterkommande byggstenar:

- Minimera trunkar och pruna (till√•t) bara relevanta VLAN per trunk; native VLAN s√§tts till ett oanv√§nt (t.ex. 999).
- BPDU Guard och PortFast p√• klientportar; Root Guard n√§ra roten; storm-control f√∂r att d√§mpa toppar.
- DHCP Snooping (avg√∂r vilka portar som f√•r vara DHCP), Dynamic ARP Inspection (DAI), IP Source Guard i accesslagret.
- ACL p√• SVI (gateway): ‚Äúdefault deny ‚Äì √∂ppna minsta m√∂jliga‚Äù.
- Private VLAN d√§r klienter i samma VLAN inte ska kunna prata direkt.
- 802.1X i accesslagret f√∂r att knyta identitet till port (MAB-fallback f√∂r skrivare/IoT).
- Separera managementytor (SSH/HTTPS/SNMP) i eget VLAN och n√• dem via bastion/jump host.

Minimera trunkar och pruna (till√•t) bara relevanta VLAN per trunk; native VLAN s√§tts till ett oanv√§nt (t.ex. 999).

BPDU Guard och PortFast p√• klientportar; Root Guard n√§ra roten; storm-control f√∂r att d√§mpa toppar.

DHCP Snooping (avg√∂r vilka portar som f√•r vara DHCP), Dynamic ARP Inspection (DAI), IP Source Guard i accesslagret.

ACL p√• SVI (gateway): ‚Äúdefault deny ‚Äì √∂ppna minsta m√∂jliga‚Äù.

Private VLAN d√§r klienter i samma VLAN inte ska kunna prata direkt.

802.1X i accesslagret f√∂r att knyta identitet till port (MAB-fallback f√∂r skrivare/IoT).

Separera managementytor (SSH/HTTPS/SNMP) i eget VLAN och n√• dem via bastion/jump host.

F√∂rtydligande (sammanfattning):

- Zoner: klient, server, g√§st, management ‚Äì och uttryckta fl√∂den.
- Accessskydd: skydda mot felkopplade switchar och kringutrustning.
- F√∂rgiftning: Snooping/DAI/Source Guard hindrar ‚Äúfalska sanningsk√§llor‚Äù.

Zoner: klient, server, g√§st, management ‚Äì och uttryckta fl√∂den.

Accessskydd: skydda mot felkopplade switchar och kringutrustning.

F√∂rgiftning: Snooping/DAI/Source Guard hindrar ‚Äúfalska sanningsk√§llor‚Äù.

Exempel: Ett ‚Äúmystiskt‚Äù DHCP-scope dyker upp ‚Äì klienter f√•r fel adresser. Med DHCP Snooping blockeras den privata routern, och Snooping-tabellen pekar ut exakt switchport. Port Security begr√§nsar MAC-antal och d√§mpar effekten av medtagen utrustning.

### 4.1.7 Protokollanalys med Wireshark

Protokollanalys svarar p√• fr√•gan vad som faktiskt h√§nde. Wireshark blir d√• ett mikroskop som visar ramar, flaggor och tidslinjer. En bra metod undviker datatsj√∂ar: b√∂rja med ett smalt syfte (‚Äúklienter f√•r inte IP‚Äù, ‚Äúl√•ngsam inloggning‚Äù), f√•nga s√• n√§ra k√§llan som m√∂jligt (klient, port-SPAN, server), och filtrera b√•de vid f√•ngst och visning. Etik och lag spelar ocks√• in: minimera (bara det som beh√∂vs), begr√§nsa inneh√•ll (undvik att spara payload i on√∂dan), och rensa material n√§r analysen √§r klar.

N√•gra vyer ger mycket v√§rde: tidslinje, Follow Stream, I/O Graphs och Expert Information. V√§lk√§nda filter: dhcp || bootp f√∂r adressdelning, dns f√∂r namn, arp f√∂r tabeller, icmp f√∂r n√•barhet, tcp.flags.syn==1 && tcp.flags.ack==0 f√∂r handskakningar, tcp.analysis.retransmission f√∂r st√∂rningar, tls.handshake f√∂r att se att TLS sker, ip.addr==X f√∂r att isolera en v√§rd. P√• WLAN kr√§vs ibland monitor-l√§ge f√∂r att se r√•a 802.11-ramar ‚Äì annars syns mest det som passerar via AP/controller.

F√∂rtydligande (sammanfattning):

- Fr√•ga f√∂rst: vad vill tidslinjen bevisa eller motbevisa?
- Smala f√•ngster: n√§ra k√§llan, kort tid, r√§tt filter.
- Hj√§lpytor: Follow Stream, Expert Info, I/O Graphs.
- Etik: f√•nga minsta m√∂jliga, skydda, rensa.

Fr√•ga f√∂rst: vad vill tidslinjen bevisa eller motbevisa?

Smala f√•ngster: n√§ra k√§llan, kort tid, r√§tt filter.

Hj√§lpytor: Follow Stream, Expert Info, I/O Graphs.

Etik: f√•nga minsta m√∂jliga, skydda, rensa.

Exempel: Klienter ‚Äúsaknar IP‚Äù i ett VLAN. F√•ngst visar DISCOVER men inga OFFER. P√• uplinken saknas trusted-flagga i DHCP Snooping, s√• rel√§trafiken stoppas. N√§r uplinken s√§tts som trusted syns OFFER/REQUEST/ACK och klienterna f√•r adresser direkt.

### 

### üìå Kontrollfr√•gor

- Vad menas med defense in depth och least privilege, och hur samverkar de?
- Koppla tre kontroller till C, I respektive A i CIA-triaden.
- F√∂rklara skillnaden mellan stateful brandv√§gg och NGFW (Next-Generation Firewall).
- Vad g√∂r en NIDS (Network Intrusion Detection System) respektive HIDS (Host Intrusion Detection System) ‚Äì och n√§r beh√∂vs b√•da?
- Hur skiljer sig IDS fr√•n IPS (Intrusion Prevention System), och vad inneb√§r inline kontra out-of-band?
- Varf√∂r kan NIDS/HIDS vara v√§rdefulla √§ven n√§r NGFW redan har IPS?
- N√§mn fem byggstenar som st√§rker VLAN-s√§kerhet i accesslagret och motivera dem kort.
- Vad g√∂r DHCP Snooping, DAI och IP Source Guard, och hur h√§nger de ihop?
- Beskriv en metod f√∂r att fels√∂ka ‚Äúl√•ngsam inloggning‚Äù med Wireshark utan att exponera on√∂dig data.
- Ge tre visningsfilter i Wireshark som snabbt ringar in problem med DHCP, DNS och TCP-anslutningar.

Vad menas med defense in depth och least privilege, och hur samverkar de?

Koppla tre kontroller till C, I respektive A i CIA-triaden.

F√∂rklara skillnaden mellan stateful brandv√§gg och NGFW (Next-Generation Firewall).

Vad g√∂r en NIDS (Network Intrusion Detection System) respektive HIDS (Host Intrusion Detection System) ‚Äì och n√§r beh√∂vs b√•da?

Hur skiljer sig IDS fr√•n IPS (Intrusion Prevention System), och vad inneb√§r inline kontra out-of-band?

Varf√∂r kan NIDS/HIDS vara v√§rdefulla √§ven n√§r NGFW redan har IPS?

N√§mn fem byggstenar som st√§rker VLAN-s√§kerhet i accesslagret och motivera dem kort.

Vad g√∂r DHCP Snooping, DAI och IP Source Guard, och hur h√§nger de ihop?

Beskriv en metod f√∂r att fels√∂ka ‚Äúl√•ngsam inloggning‚Äù med Wireshark utan att exponera on√∂dig data.

Ge tre visningsfilter i Wireshark som snabbt ringar in problem med DHCP, DNS och TCP-anslutningar.

### 

### üîó F√∂rdjupningsl√§nkar

- NIST ‚Äì Computer Security Incident Handling (√∂versikt): https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final
- NIST ‚Äì Zero Trust (ramverkst√§nk): https://csrc.nist.gov/publications/detail/sp/800-207/final
- RFC 2131 ‚Äì DHCP: https://www.rfc-editor.org/rfc/rfc2131
- RFC 1034/1035 ‚Äì DNS grunder: https://www.rfc-editor.org/rfc/rfc1034
- RFC 826 ‚Äì ARP: https://www.rfc-editor.org/rfc/rfc826
- RFC 8446 ‚Äì TLS 1.3: https://www.rfc-editor.org/rfc/rfc8446
- Wireshark ‚Äì User Guide: https://www.wireshark.org/docs/wsug_html_chunked/
- Cisco ‚Äì Campus LAN Security (designid√©er): https://www.cisco.com/c/en/us/solutions/enterprise-networks/index.html

NIST ‚Äì Computer Security Incident Handling (√∂versikt): https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final

NIST ‚Äì Zero Trust (ramverkst√§nk): https://csrc.nist.gov/publications/detail/sp/800-207/final

RFC 2131 ‚Äì DHCP: https://www.rfc-editor.org/rfc/rfc2131

RFC 1034/1035 ‚Äì DNS grunder: https://www.rfc-editor.org/rfc/rfc1034

RFC 826 ‚Äì ARP: https://www.rfc-editor.org/rfc/rfc826

RFC 8446 ‚Äì TLS 1.3: https://www.rfc-editor.org/rfc/rfc8446

Wireshark ‚Äì User Guide: https://www.wireshark.org/docs/wsug_html_chunked/

Cisco ‚Äì Campus LAN Security (designid√©er): https://www.cisco.com/c/en/us/solutions/enterprise-networks/index.html

### 

### ‚úçÔ∏è Egna anteckningar

‚Ä¶


