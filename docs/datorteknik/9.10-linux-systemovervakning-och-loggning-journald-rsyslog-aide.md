## 9.10 Linux system√∂vervakning och loggning (journald, rsyslog, AIDE)

Att √∂vervaka och logga vad som h√§nder p√• ett Linux-system √§r avg√∂rande f√∂r att kunna uppt√§cka intr√•ngsf√∂rs√∂k, sp√•ra fel eller f√∂lja upp vad som gjorts. Loggar √§r som systemets minne ‚Äì de ber√§ttar vem som gjorde vad, n√§r och hur. Utan loggar blir fels√∂kning och s√§kerhetsanalys i stort sett om√∂jlig.

#### Journald ‚Äì systemd:s loggsystem

De flesta moderna Linux-distributioner anv√§nder systemd som init-system. Tillsammans med journald hanterar det systemets k√§rnloggar, tj√§nstmeddelanden och annan systemn√§ra information. Journald lagrar loggar bin√§rt, vilket g√∂r dem mer motst√•ndskraftiga mot manipulation j√§mf√∂rt med vanliga textfiler.

üõ† Vanliga kommandon:

bash

CopyEdit

journalctl # Visa alla loggar

journalctl -b # Loggar fr√•n senaste boot

journalctl -u ssh # Endast SSH-tj√§nstens loggar

journalctl --since "1 hour ago" # Loggar fr√•n senaste timmen

Tips:

- Anv√§nd less f√∂r att bl√§ddra bekv√§mt i l√§ngre loggar.
- Filtrera med grep f√∂r att s√∂ka efter specifika rader:

journalctl -u ssh | grep "Failed"

Vill du exportera loggar till text?

journalctl -u ssh > ssh-logg.txt

#### Rsyslog ‚Äì klassisk textbaserad logghantering

Ut√∂ver journald anv√§nds ofta rsyslog f√∂r att skicka loggar till olika textfiler, vanligtvis under /var/log. Systemet √§r kraftfullt och anv√§nds ofta f√∂r att:

- Centralisera loggar fr√•n flera servrar
- Skicka loggar till externa logghanteringssystem
- Definiera egna regler f√∂r filtrering och lagring

üìÅ Exempel p√• vanliga loggfiler:

| /var/log/auth.log | Inloggningar, sudo, autentisering |
| --- | --- |
| /var/log/syslog | Allm√§n systemlogg |
| /var/log/kern.log | K√§rnrelaterade meddelanden |
| /var/log/apt/history.log | Installationshistorik via apt |
| /var/log/faillog | Misslyckade inloggningsf√∂rs√∂k |

Konfigurationen sker i:

- /etc/rsyslog.conf (huvudfil)
- /etc/rsyslog.d/ (egna regler)

F√∂r att ladda om rsyslog efter √§ndring:

sudo systemctl restart rsyslog

#### AIDE ‚Äì Advanced Intrusion Detection Environment

AIDE √§r ett verktyg f√∂r att kontrollera om n√•got i filsystemet har f√∂r√§ndrats ‚Äì till exempel om en systemfil modifierats utan att du vet om det. Det fungerar som ett ‚Äúf√∂re-efter‚Äù-system: f√∂rst skapas en s√§kerhetskopia av systemets skick, och d√§refter kontrolleras det regelbundet.

üì¶ S√• h√§r kommer du ig√•ng:

sudo apt install aide

sudo aideinit # Skapar ursprungsdatabasen

sudo aide.wrapper --check # J√§mf√∂r aktuell status med databasen

‚ö† Viktigt:Den ursprungliga databasen (/var/lib/aide/aide.db.new) b√∂r flyttas till en s√§ker plats ‚Äì helst offline ‚Äì efter f√∂rsta k√∂rningen. Om en angripare n√•r databasen kan den manipuleras f√∂r att d√∂lja sp√•r.

üìÖ Automatisering:Schemal√§gg AIDE s√• att det k√∂rs varje natt med cron eller systemd timers.

Exempel med cron:

0 2 * * * /usr/bin/aide.wrapper --check

#### Varf√∂r √§r detta viktigt?

- Loggar ger sp√•rbarhet ‚Äì du vet vem som gjort vad, och n√§r.
- De anv√§nds i incidentutredningar vid intr√•ng eller misstag.
- Ett f√∂r√§ndrat system utan din vetskap √§r ofta tecken p√• en attack.
- Automatisk √∂vervakning g√∂r det m√∂jligt att reagera snabbt ‚Äì innan skadan √§r skedd.

### 

### 9.10.1 Kontrollfr√•gor

- Vad √§r journald och vilken typ av loggar hanterar det?
- Vad g√∂r kommandot journalctl -u ssh?
- N√§mn tv√• skillnader mellan journald och rsyslog.
- Var sparas vanligen klassiska loggfiler i Linux?
- Vad anv√§nds /var/log/auth.log till?
- Vad √§r AIDE och vilket s√§kerhetssyfte fyller det?
- Vad h√§nder vid ett AIDE-check om en systemfil har √§ndrats?
- Varf√∂r √§r det viktigt att spara AIDEs databas p√• ett s√§kert st√§lle?
- Hur kan AIDE automatiseras f√∂r daglig kontroll?
- Hur kan loggar anv√§ndas vid s√§kerhetsincidenter?

### 

### 9.10.2 F√∂rdjupningsl√§nkar

- Red Hat ‚Äì Introduction to journalctl[https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/sect-basic_system_administration-working_with_system_log_files](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/sect-basic_system_administration-working_with_system_log_files)
- Ubuntu ‚Äì Log Files Explained [https://help.ubuntu.com/community/LinuxLogFiles](https://help.ubuntu.com/community/LinuxLogFiles)
- rsyslog ‚Äì Officiell dokumentation [https://www.rsyslog.com/doc/](https://www.rsyslog.com/doc/)
- AIDE Project [https://aide.github.io/](https://aide.github.io/)
- Loggning i Linux ‚Äì Comparitech [https://www.comparitech.com/net-admin/linux-logging/](https://www.comparitech.com/net-admin/linux-logging/)

### 

### 9.10.3 Egna anteckningar

(L√§mna plats f√∂r egna reflektioner och kompletterande information h√§r.)
