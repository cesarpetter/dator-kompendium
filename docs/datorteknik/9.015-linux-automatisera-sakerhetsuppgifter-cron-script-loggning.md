# 9 Introduktion till IT-säkerhet

## 9.15 Linux automatisera säkerhetsuppgifter (cron, script, loggning)

Att automatisera återkommande uppgifter i Linux är en av de största fördelarna med systemet – och det gäller särskilt när det handlar om säkerhet. Genom att schemalägga uppgifter som uppdateringar, loggrensning, säkerhetskopiering eller övervakning kan du minimera risken för den mänskliga faktorn och säkerställa att skyddet är aktivt dygnet runt.

#### cron – Linux inbyggda schemaläggare

cron används för att köra kommandon vid återkommande tidpunkter.

Struktur i crontab:


* * * * * kommando

│ │ │ │ │

│ │ │ │ └─ dag i veckan (0–6, söndag=0)

│ │ │ └─── månad (1–12)

│ │ └───── dag i månaden (1–31)

│ └─────── timme (0–23)

└───────── minut (0–59)

Exempel:
Kör ett script varje natt kl. 02:00:

0 2 * * * /home/admin/scripts/update-check.sh

Tips: Använd crontab -e för att redigera användarens schema. För systemomfattande jobb används /etc/crontab.

#### Bash-script – Automatisering i praktiken

Script låter dig skapa anpassade säkerhetsrutiner.

Exempel: Automatiserat uppdateringsscript

#!/bin/bash

echo "Uppdatering startade: $(date)" >> /var/log/uppdatering.log

apt update && apt upgrade -y >> /var/log/uppdatering.log 2>&1

echo "Färdigt: $(date)" >> /var/log/uppdatering.log

Spara som /home/admin/scripts/update-check.sh och gör körbar:

chmod +x update-check.sh

Lägg till i cron:

0 3 * * * /home/admin/scripts/update-check.sh

#### Loggning – Sätt att hålla koll på vad som händer

I Linux loggas det mesta, särskilt sådant som rör systemet och säkerhet.

Viktiga loggfiler:

- /var/log/auth.log – inloggningar och sudo-kommandon
- /var/log/syslog – generell systemlogg
- /var/log/ufw.log – brandväggsloggar (om UFW används)
- /var/log/apt/history.log – installationshistorik

/var/log/auth.log – inloggningar och sudo-kommandon

/var/log/syslog – generell systemlogg

/var/log/ufw.log – brandväggsloggar (om UFW används)

/var/log/apt/history.log – installationshistorik

Visa senaste 20 rader i auth.log:

tail -n 20 /var/log/auth.log

Övervaka logg i realtid:

tail -f /var/log/syslog

#### Automatiserad övervakning (med t.ex. fail2ban)

fail2ban är ett verktyg som automatiskt blockerar IP-adresser som upprepat försöker logga in felaktigt – t.ex. via SSH.

Installation:

sudo apt install fail2ban

Starta och aktivera:

sudo systemctl enable --now fail2ban

Visa logg:

cat /var/log/fail2ban.log

fail2ban övervakar bl.a. /var/log/auth.log för att upptäcka attacker.

#### Rekommenderade säkerhetsrutiner att automatisera

| Åtgärd | Verktyg | Frekvens | Exempel |
| --- | --- | --- | --- |
| Systemuppdatering | apt + cron | Dagligen | update-check.sh |
| Backup | rsync/tar + cron | Dagligen/veckovis | backup.sh |
| Loggrensning | logrotate | Veckovis | /etc/logrotate.d/ |
| Säkerhetskontroll | script + cron | Veckovis | T.ex. kontrollera öppna portar |
| Antivirusgenomsökning | clamav + cron | Veckovis | clamscan -r /home |

Åtgärd

Verktyg

Frekvens

Exempel

Systemuppdatering

apt + cron

Dagligen

update-check.sh

Backup

rsync/tar + cron

Dagligen/veckovis

backup.sh

Loggrensning

logrotate

Veckovis

/etc/logrotate.d/

Säkerhetskontroll

script + cron

Veckovis

T.ex. kontrollera öppna portar

Antivirusgenomsökning

clamav + cron

Veckovis

clamscan -r /home


