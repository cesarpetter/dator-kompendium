---
title: "9.12 Linux h√§rdning av tj√§nster (t.ex. SSH, brandv√§gg, TLS/SSL)"
parent: "Datorteknik"
nav_order: 912
---

# 9.12 Linux h√§rdning av tj√§nster (t.ex. SSH, brandv√§gg, TLS/SSL)

H√§rdning inneb√§r att minska attackytan f√∂r ett system genom att st√§nga av on√∂diga funktioner, s√§kra konfigurationer och begr√§nsa √•tkomst. M√•let √§r att g√∂ra det s√• sv√•rt som m√∂jligt f√∂r en angripare att ta sig in ‚Äì och s√• l√§tt som m√∂jligt att uppt√§cka f√∂rs√∂k.
H√§r tittar vi n√§rmare p√• n√•gra vanliga tj√§nster och hur du s√§krar dem.
#### SSH ‚Äì Secure Shell
SSH anv√§nds f√∂r att fj√§rransluta till Linux-system. Det √§r kraftfullt ‚Äì men ocks√• ett vanligt m√•l f√∂r automatiserade attacker.
‚úÖ Rekommenderade inst√§llningar f√∂r s√§krare SSH:
- Byt standardport fr√•n 22 till n√•got annat, t.ex. 2222(OBS: detta stoppar inte en attack, men minskar m√§ngden skriptade f√∂rs√∂k)
Byt standardport fr√•n 22 till n√•got annat, t.ex. 2222(OBS: detta stoppar inte en attack, men minskar m√§ngden skriptade f√∂rs√∂k)
sudo nano /etc/ssh/sshd_config
# Port 2222
- St√§ng av inloggning som rootRoot b√∂r aldrig kunna logga in via SSH ‚Äì anv√§nd ist√§llet sudo.
St√§ng av inloggning som rootRoot b√∂r aldrig kunna logga in via SSH ‚Äì anv√§nd ist√§llet sudo.
PermitRootLogin no
- Till√•t endast nyckelbaserad autentiseringKr√§ver att anv√§ndaren har en privat SSH-nyckel i sin klient.
Till√•t endast nyckelbaserad autentiseringKr√§ver att anv√§ndaren har en privat SSH-nyckel i sin klient.
PasswordAuthentication no
- Begr√§nsa vilka anv√§ndare som f√•r logga in via SSH:
Begr√§nsa vilka anv√§ndare som f√•r logga in via SSH:
AllowUsers robin adminuser
- Starta om SSH f√∂r att ladda in √§ndringar:
Starta om SSH f√∂r att ladda in √§ndringar:
sudo systemctl restart ssh
üí° Tips: Anv√§nd fail2ban f√∂r att blockera IP-adresser som f√∂rs√∂ker logga in upprepade g√•nger med fel l√∂senord. Det skyddar s√§rskilt bra mot brute-force-attacker.
#### Brandv√§gg ‚Äì UFW (Uncomplicated Firewall)
En brandv√§gg kontrollerar vilken trafik som f√•r passera in eller ut fr√•n datorn. ufw √§r ett anv√§ndarv√§nligt gr√§nssnitt till den kraftfulla brandv√§ggen iptables.
‚úÖ S√• kommer du ig√•ng med UFW:
sudo apt install ufw
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp # Till√•t SSH (eller 2222 om du bytt port)
sudo ufw enable
üìå OBS: L√§gg alltid till regler f√∂r fj√§rr√•tkomst innan du aktiverar ufw, annars riskerar du att l√•sa ute dig sj√§lv!
üîç Visa status:
sudo ufw status verbose
#### TLS/SSL ‚Äì Krypterad kommunikation
TLS (Transport Layer Security) √§r efterf√∂ljaren till SSL (Secure Sockets Layer), och anv√§nds f√∂r att skydda data under √∂verf√∂ring. Du har sett det i praktiken n√§r du bes√∂ker en webbplats med https://.
üì¶ Installera Let's Encrypt-certifikat med Certbot:
sudo apt install certbot python3-certbot-apache
sudo certbot --apache
- F√∂r Nginx: byt --apache mot --nginx.
F√∂r Nginx: byt --apache mot --nginx.
üéØ Varf√∂r TLS/SSL?
- Skyddar all kommunikation fr√•n avlyssning
- Bekr√§ftar webbplatsens identitet
- Ger √•tkomst till HTTPS ‚Äì ett krav i moderna webbl√§sare
Skyddar all kommunikation fr√•n avlyssning
Bekr√§ftar webbplatsens identitet
Ger √•tkomst till HTTPS ‚Äì ett krav i moderna webbl√§sare
‚öôÔ∏è Automatisk f√∂rnyelse av certifikat:
Certbot installerar som standard en systemd-timer:
sudo systemctl status certbot.timer
Om det fungerar visas en aktiv timer som k√∂r certbot renew regelbundet.
### 9.12.1 Kontrollfr√•gor
- Vad inneb√§r det att "h√§rda" ett system?
- Varf√∂r √§r det bra att byta port f√∂r SSH fr√•n 22?
- Vad g√∂r inst√§llningen PermitRootLogin no?
- Hur fungerar SSH-nycklar som autentisering?
- Vad √§r ufw, och vad anv√§nds det till?
- Hur ser du vilka regler som √§r aktiva i ufw?
- Vad inneb√§r ufw default deny incoming?
- Vad √§r TLS/SSL och vad anv√§nds det till?
- Hur skaffar man ett gratis SSL-certifikat i Ubuntu?
- Varf√∂r √§r det viktigt att f√∂rnya TLS-certifikat?
Vad inneb√§r det att "h√§rda" ett system?
Varf√∂r √§r det bra att byta port f√∂r SSH fr√•n 22?
Vad g√∂r inst√§llningen PermitRootLogin no?
Hur fungerar SSH-nycklar som autentisering?
Vad √§r ufw, och vad anv√§nds det till?
Hur ser du vilka regler som √§r aktiva i ufw?
Vad inneb√§r ufw default deny incoming?
Vad √§r TLS/SSL och vad anv√§nds det till?
Hur skaffar man ett gratis SSL-certifikat i Ubuntu?
Varf√∂r √§r det viktigt att f√∂rnya TLS-certifikat?
### 9.12.2 F√∂rdjupningsl√§nkar
- SSH Hardening Guide (Ubuntu) https://ubuntu.com/server/docs/service-openssh
- UFW Firewall Tutorial https://help.ubuntu.com/community/UFW
- Let's Encrypt (gratis TLS-certifikat) https://letsencrypt.org/
- Mozilla SSL Configuration Generator https://ssl-config.mozilla.org/
- OWASP ‚Äì TLS Best Practices https://owasp.org/www-project-cheat-sheets/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html
SSH Hardening Guide (Ubuntu) https://ubuntu.com/server/docs/service-openssh
UFW Firewall Tutorial https://help.ubuntu.com/community/UFW
Let's Encrypt (gratis TLS-certifikat) https://letsencrypt.org/
Mozilla SSL Configuration Generator https://ssl-config.mozilla.org/
OWASP ‚Äì TLS Best Practices https://owasp.org/www-project-cheat-sheets/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html
### 9.12.3 Egna anteckningar
(H√§r kan du skriva ner egna exempel p√• h√§rdning du testat, vilka regler du satt upp i ufw, eller inst√§llningar du gjort i sshd_config.)